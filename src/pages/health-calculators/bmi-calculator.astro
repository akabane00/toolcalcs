---
import BaseLayout from '../../layouts/BaseLayout.astro';
import AdUnit from '../../components/AdUnit.astro';

const structuredData = {
  '@context': 'https://schema.org',
  '@type': 'FAQPage',
  mainEntity: [
    {
      '@type': 'Question',
      name: 'What is a healthy BMI range?',
      acceptedAnswer: {
        '@type': 'Answer',
        text: 'A healthy BMI is generally considered to be between 18.5 and 24.9. Below 18.5 is underweight, 25-29.9 is overweight, and 30 or above is classified as obese.',
      },
    },
    {
      '@type': 'Question',
      name: 'How accurate is BMI?',
      acceptedAnswer: {
        '@type': 'Answer',
        text: 'BMI is a useful screening tool but has limitations. It does not distinguish between muscle and fat mass, so athletes may have a high BMI despite being healthy. Age, sex, and ethnicity can also affect the interpretation.',
      },
    },
  ],
};
---

<BaseLayout
  title="BMI Calculator - Check Your Body Mass Index"
  description="Free BMI calculator. Enter your height and weight to calculate your Body Mass Index and see which health category you fall into."
  type="article"
  structuredData={structuredData}
>
  <nav class="breadcrumb">
    <a href="/">Home</a> &rsaquo;
    <a href="/health-calculators/">Health Calculators</a> &rsaquo;
    <span>BMI Calculator</span>
  </nav>

  <h1>BMI Calculator</h1>
  <p class="page-desc">Calculate your Body Mass Index to understand your weight relative to your height.</p>

  <div class="calculator-box">
    <div class="unit-toggle">
      <button class="toggle-btn active" data-unit="imperial">Imperial (lbs/ft)</button>
      <button class="toggle-btn" data-unit="metric">Metric (kg/cm)</button>
    </div>

    <div class="calc-inputs">
      <div class="input-row" id="imperialInputs">
        <div class="input-group">
          <label for="feet">Height (feet)</label>
          <input type="number" id="feet" value="5" min="1" max="8" step="1" />
        </div>
        <div class="input-group">
          <label for="inches">Inches</label>
          <input type="number" id="inches" value="10" min="0" max="11" step="1" />
        </div>
        <div class="input-group">
          <label for="weightLbs">Weight (lbs)</label>
          <input type="number" id="weightLbs" value="160" min="1" step="1" />
        </div>
      </div>
      <div class="input-row hidden" id="metricInputs">
        <div class="input-group">
          <label for="heightCm">Height (cm)</label>
          <input type="number" id="heightCm" value="178" min="50" max="250" step="1" />
        </div>
        <div class="input-group">
          <label for="weightKg">Weight (kg)</label>
          <input type="number" id="weightKg" value="73" min="1" step="0.1" />
        </div>
      </div>
      <button class="calc-btn" id="calculateBtn">Calculate BMI</button>
    </div>

    <div class="calc-results" id="results">
      <div class="bmi-display">
        <span class="bmi-number" id="bmiValue">0</span>
        <span class="bmi-category" id="bmiCategory">-</span>
      </div>
      <div class="bmi-scale">
        <div class="scale-bar">
          <div class="scale-segment underweight">Underweight<br/>&lt;18.5</div>
          <div class="scale-segment normal">Normal<br/>18.5-24.9</div>
          <div class="scale-segment overweight">Overweight<br/>25-29.9</div>
          <div class="scale-segment obese">Obese<br/>30+</div>
        </div>
        <div class="scale-marker" id="bmiMarker"></div>
      </div>
      <div class="bmi-info" id="bmiInfo"></div>
    </div>
  </div>

  <AdUnit slot="calc-mid" format="rectangle" />

  <article class="content-section">
    <h2>What Is BMI?</h2>
    <p>Body Mass Index (BMI) is a numerical value calculated from your weight and height. It provides a simple screening measure to categorize individuals as underweight, normal weight, overweight, or obese. BMI was developed by Belgian mathematician Adolphe Quetelet in the 1830s.</p>

    <h2>BMI Formula</h2>
    <div class="formula-box">
      <code>BMI = weight (kg) / height (m)<sup>2</sup></code>
    </div>
    <p>Or in imperial units:</p>
    <div class="formula-box">
      <code>BMI = 703 &times; weight (lbs) / height (inches)<sup>2</sup></code>
    </div>

    <h2>BMI Categories</h2>
    <table class="info-table">
      <thead>
        <tr><th>BMI Range</th><th>Category</th></tr>
      </thead>
      <tbody>
        <tr><td>Below 18.5</td><td>Underweight</td></tr>
        <tr><td>18.5 - 24.9</td><td>Normal weight</td></tr>
        <tr><td>25.0 - 29.9</td><td>Overweight</td></tr>
        <tr><td>30.0 - 34.9</td><td>Obese (Class I)</td></tr>
        <tr><td>35.0 - 39.9</td><td>Obese (Class II)</td></tr>
        <tr><td>40.0 and above</td><td>Obese (Class III)</td></tr>
      </tbody>
    </table>

    <h2>Limitations of BMI</h2>
    <p>While BMI is widely used, it has important limitations:</p>
    <ul>
      <li><strong>Muscle vs. fat:</strong> Athletes and bodybuilders may have a high BMI due to muscle mass, not excess fat.</li>
      <li><strong>Age:</strong> Older adults tend to have more body fat than younger adults at the same BMI.</li>
      <li><strong>Sex:</strong> Women generally have more body fat than men at the same BMI.</li>
      <li><strong>Body fat distribution:</strong> BMI does not account for where fat is stored. Abdominal fat is more dangerous than fat in other areas.</li>
    </ul>
    <p>BMI should be used as a starting point, not a definitive measure of health. Consult a healthcare provider for a comprehensive health assessment.</p>

    <h2>Frequently Asked Questions</h2>
    <h3>What is a healthy BMI range?</h3>
    <p>A healthy BMI is generally considered to be between 18.5 and 24.9. However, this range may vary by ethnicity and age. Some health organizations suggest lower cutoffs for Asian populations (23 for overweight, 27.5 for obese).</p>

    <h3>How accurate is BMI?</h3>
    <p>BMI is a useful screening tool for populations but has limitations for individuals. It does not measure body fat directly and cannot distinguish between muscle and fat. For a more accurate assessment, consider measurements like waist circumference, body fat percentage, or DEXA scans.</p>
  </article>

  <AdUnit slot="calc-bottom" format="horizontal" />
</BaseLayout>

<style>
  .breadcrumb { font-size: 0.85rem; color: var(--color-text-muted); margin-bottom: 16px; }
  .breadcrumb a { color: var(--color-text-muted); }
  .breadcrumb a:hover { color: var(--color-primary); }
  h1 { font-size: 1.8rem; margin-bottom: 8px; }
  .page-desc { color: var(--color-text-muted); margin-bottom: 24px; }

  .calculator-box {
    background: var(--color-surface);
    border: 1px solid var(--color-border);
    border-radius: var(--radius);
    padding: 24px;
    margin-bottom: 32px;
  }
  .unit-toggle {
    display: flex;
    gap: 4px;
    margin-bottom: 20px;
    background: var(--color-bg);
    border-radius: var(--radius);
    padding: 4px;
    width: fit-content;
  }
  .toggle-btn {
    padding: 8px 16px;
    border: none;
    border-radius: 6px;
    background: transparent;
    font-size: 0.85rem;
    font-weight: 500;
    cursor: pointer;
    color: var(--color-text-muted);
    transition: all 0.15s;
  }
  .toggle-btn.active {
    background: var(--color-surface);
    color: var(--color-primary);
    box-shadow: var(--shadow-sm);
  }
  .input-row {
    display: flex;
    gap: 16px;
    flex-wrap: wrap;
    margin-bottom: 16px;
  }
  .input-row.hidden { display: none; }
  .input-group { display: flex; flex-direction: column; gap: 4px; flex: 1; min-width: 120px; }
  .input-group label { font-size: 0.85rem; font-weight: 600; color: var(--color-text-muted); }
  .input-group input {
    padding: 10px 12px;
    border: 1px solid var(--color-border);
    border-radius: var(--radius);
    font-size: 1rem;
    background: var(--color-bg);
  }
  .input-group input:focus { outline: none; border-color: var(--color-primary); box-shadow: 0 0 0 3px rgba(37,99,235,0.1); }
  .calc-btn {
    padding: 10px 24px;
    background: var(--color-primary);
    color: #fff;
    border: none;
    border-radius: var(--radius);
    font-size: 1rem;
    font-weight: 600;
    cursor: pointer;
  }
  .calc-btn:hover { background: var(--color-primary-dark); }

  .bmi-display {
    text-align: center;
    margin: 24px 0 16px;
  }
  .bmi-number {
    display: block;
    font-size: 3rem;
    font-weight: 800;
    color: var(--color-primary);
  }
  .bmi-category {
    display: block;
    font-size: 1.1rem;
    font-weight: 600;
    margin-top: 4px;
  }
  .bmi-scale { margin: 24px 0; position: relative; }
  .scale-bar {
    display: flex;
    border-radius: var(--radius);
    overflow: hidden;
    font-size: 0.75rem;
    text-align: center;
    font-weight: 500;
  }
  .scale-segment { padding: 12px 4px; color: #fff; flex: 1; }
  .scale-segment.underweight { background: #60a5fa; }
  .scale-segment.normal { background: #34d399; }
  .scale-segment.overweight { background: #fbbf24; }
  .scale-segment.obese { background: #f87171; }
  .scale-marker {
    position: absolute;
    top: -8px;
    width: 4px;
    height: calc(100% + 16px);
    background: var(--color-text);
    border-radius: 2px;
    transition: left 0.3s;
    display: none;
  }
  .bmi-info {
    margin-top: 16px;
    padding: 12px 16px;
    background: var(--color-bg);
    border-radius: var(--radius);
    font-size: 0.9rem;
    line-height: 1.6;
  }

  .content-section { max-width: 800px; line-height: 1.8; }
  .content-section h2 { font-size: 1.3rem; margin: 32px 0 12px; padding-top: 16px; border-top: 1px solid var(--color-border); }
  .content-section h2:first-child { border-top: none; margin-top: 0; }
  .content-section h3 { font-size: 1.1rem; margin: 24px 0 8px; }
  .content-section p { margin-bottom: 12px; }
  .content-section ul, .content-section ol { margin: 0 0 16px 24px; }
  .content-section li { margin-bottom: 6px; }
  .formula-box {
    background: var(--color-bg);
    border: 1px solid var(--color-border);
    border-radius: var(--radius);
    padding: 16px 24px;
    margin: 16px 0;
    font-size: 1.2rem;
    text-align: center;
  }
  .info-table { width: 100%; max-width: 400px; border-collapse: collapse; margin: 16px 0; }
  .info-table th, .info-table td { padding: 8px 16px; border: 1px solid var(--color-border); text-align: left; }
  .info-table th { background: var(--color-bg); font-weight: 600; }

  @media (max-width: 640px) {
    .input-row { flex-direction: column; }
  }
</style>

<script>
  let unit: 'imperial' | 'metric' = 'imperial';

  document.querySelectorAll('.toggle-btn').forEach(btn => {
    btn.addEventListener('click', () => {
      document.querySelectorAll('.toggle-btn').forEach(b => b.classList.remove('active'));
      btn.classList.add('active');
      unit = (btn as HTMLElement).dataset.unit as 'imperial' | 'metric';
      document.getElementById('imperialInputs')!.classList.toggle('hidden', unit !== 'imperial');
      document.getElementById('metricInputs')!.classList.toggle('hidden', unit !== 'metric');
    });
  });

  function calculate() {
    let bmi: number;

    if (unit === 'imperial') {
      const feet = parseFloat((document.getElementById('feet') as HTMLInputElement).value) || 0;
      const inches = parseFloat((document.getElementById('inches') as HTMLInputElement).value) || 0;
      const weight = parseFloat((document.getElementById('weightLbs') as HTMLInputElement).value) || 0;
      const totalInches = feet * 12 + inches;
      if (totalInches === 0 || weight === 0) return;
      bmi = (703 * weight) / (totalInches * totalInches);
    } else {
      const height = parseFloat((document.getElementById('heightCm') as HTMLInputElement).value) || 0;
      const weight = parseFloat((document.getElementById('weightKg') as HTMLInputElement).value) || 0;
      if (height === 0 || weight === 0) return;
      const heightM = height / 100;
      bmi = weight / (heightM * heightM);
    }

    document.getElementById('bmiValue')!.textContent = bmi.toFixed(1);

    let category = '';
    let color = '';
    let info = '';

    if (bmi < 18.5) {
      category = 'Underweight'; color = '#60a5fa';
      info = 'Your BMI suggests you are underweight. Consider consulting a healthcare provider about nutrition and healthy weight gain strategies.';
    } else if (bmi < 25) {
      category = 'Normal Weight'; color = '#34d399';
      info = 'Your BMI is within the healthy range. Maintain a balanced diet and regular physical activity to stay healthy.';
    } else if (bmi < 30) {
      category = 'Overweight'; color = '#fbbf24';
      info = 'Your BMI suggests you are overweight. Consider adopting healthier eating habits and increasing physical activity.';
    } else {
      category = 'Obese'; color = '#f87171';
      info = 'Your BMI indicates obesity. Consult a healthcare provider for personalized advice on weight management.';
    }

    const catEl = document.getElementById('bmiCategory')!;
    catEl.textContent = category;
    catEl.style.color = color;
    document.getElementById('bmiInfo')!.textContent = info;

    // Position marker on scale
    const marker = document.getElementById('bmiMarker')!;
    const clampedBmi = Math.min(Math.max(bmi, 15), 40);
    const percent = ((clampedBmi - 15) / (40 - 15)) * 100;
    marker.style.left = percent + '%';
    marker.style.display = 'block';
  }

  document.getElementById('calculateBtn')?.addEventListener('click', calculate);
  calculate();
</script>
