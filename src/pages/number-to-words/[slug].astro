---
import BaseLayout from '../../layouts/BaseLayout.astro';
import AdUnit from '../../components/AdUnit.astro';
import '../../styles/calculator.css';
import { getAllNumberWordsPages, type NumberWordsPage } from '../../data/number-to-words';

export function getStaticPaths() {
  return getAllNumberWordsPages().map((page) => ({
    params: { slug: page.slug },
    props: { page },
  }));
}

const { page } = Astro.props as { page: NumberWordsPage };
const { number, words, capitalizedWords, ordinal, ordinalSuffix, digitCount, isEven, isPrime } = page;

const fmt = (n: number) => n.toLocaleString('en-US');
const allPages = getAllNumberWordsPages();

// Find nearby pages
const currentIdx = allPages.findIndex((p) => p.number === number);
const nearbyPages: NumberWordsPage[] = [];
if (currentIdx > 0) nearbyPages.push(allPages[currentIdx - 1]);
if (currentIdx > 1) nearbyPages.push(allPages[currentIdx - 2]);
if (currentIdx < allPages.length - 1) nearbyPages.push(allPages[currentIdx + 1]);
if (currentIdx < allPages.length - 2) nearbyPages.push(allPages[currentIdx + 2]);
nearbyPages.sort((a, b) => a.number - b.number);

// Related pages: same magnitude
const magnitude = Math.pow(10, Math.floor(Math.log10(number)));
const relatedPages = allPages
  .filter((p) => p.number !== number && p.number >= magnitude && p.number < magnitude * 10)
  .slice(0, 6);

// Place value breakdown
function getPlaceValues(n: number): { place: string; digit: number; value: number }[] {
  const placeNames = ['ones', 'tens', 'hundreds', 'thousands', 'ten-thousands', 'hundred-thousands', 'millions', 'ten-millions', 'hundred-millions', 'billions'];
  const digits = String(n).split('').reverse();
  return digits.map((d, i) => ({
    place: placeNames[i] || `10^${i}`,
    digit: parseInt(d, 10),
    value: parseInt(d, 10) * Math.pow(10, i),
  })).reverse().filter((pv) => pv.value > 0 || digits.length === 1);
}

const placeValues = getPlaceValues(number);

// SEO
const title = `${fmt(number)} in Words - ${capitalizedWords} | ToolCalcs`;
const description = `${fmt(number)} in words is "${words}." Learn how to write ${fmt(number)} in English, its ordinal form (${ordinal}), place value, and number facts.`;

const parityWord = isEven ? 'even' : 'odd';
const primeWord = isPrime ? 'a prime number' : 'a composite number';

const structuredData = [
  {
    "@context": "https://schema.org",
    "@type": "BreadcrumbList",
    "itemListElement": [
      { "@type": "ListItem", "position": 1, "name": "Home", "item": "https://toolcalcs.com/" },
      { "@type": "ListItem", "position": 2, "name": "Math Calculators", "item": "https://toolcalcs.com/math-calculators/" },
      { "@type": "ListItem", "position": 3, "name": `${fmt(number)} in Words` },
    ],
  },
  {
    "@context": "https://schema.org",
    "@type": "FAQPage",
    "mainEntity": [
      {
        "@type": "Question",
        "name": `How do you write ${fmt(number)} in words?`,
        "acceptedAnswer": {
          "@type": "Answer",
          "text": `${fmt(number)} in words is written as "${words}."`,
        },
      },
      {
        "@type": "Question",
        "name": `What is the ordinal form of ${fmt(number)}?`,
        "acceptedAnswer": {
          "@type": "Answer",
          "text": `The ordinal form of ${fmt(number)} is "${ordinal}" or "${ordinalSuffix}."`,
        },
      },
      {
        "@type": "Question",
        "name": `Is ${fmt(number)} an even or odd number?`,
        "acceptedAnswer": {
          "@type": "Answer",
          "text": `${fmt(number)} is an ${parityWord} number${number > 1 ? ` and ${primeWord}` : ''}.`,
        },
      },
    ],
  },
];
---

<BaseLayout title={title} description={description} type="article" structuredData={structuredData}>
  <nav class="breadcrumb">
    <a href="/">Home</a> &rsaquo;
    <a href="/math-calculators/">Math Calculators</a> &rsaquo;
    <span>{fmt(number)} in Words</span>
  </nav>

  <h1>{fmt(number)} in Words</h1>
  <p class="page-desc">How to write {fmt(number)} in English words, ordinal form, and place value.</p>

  <!-- Quick Answer -->
  <div class="quick-fact">
    <span class="quick-fact-label">In Words:</span>
    <strong>"{words}"</strong>
  </div>

  <!-- Number Facts Cards -->
  <div class="calculator-box">
    <div class="facts-grid">
      <div class="fact-card primary">
        <span class="fact-value">"{words}"</span>
        <span class="fact-label">In Words</span>
      </div>
      <div class="fact-card">
        <span class="fact-value">"{ordinal}"</span>
        <span class="fact-label">Ordinal Words</span>
      </div>
      <div class="fact-card">
        <span class="fact-value">{ordinalSuffix}</span>
        <span class="fact-label">Ordinal Number</span>
      </div>
      <div class="fact-card">
        <span class="fact-value">{digitCount}</span>
        <span class="fact-label">{digitCount === 1 ? 'Digit' : 'Digits'}</span>
      </div>
      <div class="fact-card">
        <span class="fact-value">{isEven ? 'Even' : 'Odd'}</span>
        <span class="fact-label">Parity</span>
      </div>
      {number > 1 && (
        <div class="fact-card">
          <span class="fact-value">{isPrime ? 'Prime' : 'Composite'}</span>
          <span class="fact-label">Primality</span>
        </div>
      )}
    </div>
  </div>

  <!-- Interactive Converter -->
  <h2 class="section-heading">Number to Words Converter</h2>
  <div class="calculator-box">
    <div class="converter-row">
      <div class="input-group">
        <label for="numInput">Enter a Number</label>
        <input type="number" id="numInput" value={number} min="0" max="999999999999" />
      </div>
    </div>
    <div class="converter-result" id="wordsResult">{words}</div>
  </div>

  <!-- Place Value Breakdown -->
  {placeValues.length > 1 && (
    <h2 class="section-heading">Place Value Breakdown</h2>
    <div class="calculator-box">
      <table class="data-table">
        <thead>
          <tr>
            <th>Place</th>
            <th>Digit</th>
            <th>Value</th>
          </tr>
        </thead>
        <tbody>
          {placeValues.map((pv) => (
            <tr>
              <td>{pv.place}</td>
              <td>{pv.digit}</td>
              <td>{fmt(pv.value)}</td>
            </tr>
          ))}
        </tbody>
      </table>
    </div>
  )}

  <!-- Nearby Numbers -->
  {nearbyPages.length > 0 && (
    <h2 class="section-heading">Nearby Numbers</h2>
    <div class="calculator-box">
      <table class="data-table">
        <thead>
          <tr>
            <th>Number</th>
            <th>In Words</th>
            <th>Ordinal</th>
          </tr>
        </thead>
        <tbody>
          {nearbyPages.map((p) => (
            <tr>
              <td><a href={`/number-to-words/${p.slug}/`}>{fmt(p.number)}</a></td>
              <td>{p.words}</td>
              <td>{p.ordinalSuffix}</td>
            </tr>
          ))}
        </tbody>
      </table>
    </div>
  )}

  <AdUnit slot="numwords-mid" format="rectangle" />

  <!-- Content Section -->
  <article class="content-section">
    <h2>How to Write {fmt(number)} in Words</h2>
    <p>
      The number {fmt(number)} is written in English as "{words}." This is the standard way to spell out {fmt(number)} on checks, legal documents, formal writing, and any context where numbers must be expressed as text rather than digits.
    </p>
    <p>
      The ordinal form of {fmt(number)} is "{ordinal}," written in numeric shorthand as "{ordinalSuffix}." Ordinal numbers indicate position or order in a sequence, such as first place, second chapter, or {ordinalSuffix} anniversary.
    </p>

    <h2>Number Facts About {fmt(number)}</h2>
    <p>
      {fmt(number)} is a {digitCount}-digit {parityWord} number. {isEven ? `It is even because it is divisible by 2 (${fmt(number)} ÷ 2 = ${fmt(number / 2)}).` : `It is odd because it is not evenly divisible by 2.`}
      {number > 1 ? ` It is ${primeWord}${isPrime ? ', meaning its only factors are 1 and itself' : ', meaning it has factors other than 1 and itself'}.` : ''}
    </p>

    <h2>When to Write Numbers as Words</h2>
    <p>
      There are several situations where writing numbers as words is required or preferred. On checks and financial documents, the amount must be spelled out to prevent alteration. In formal and legal writing, numbers are often written as words for clarity and precision. Many style guides recommend spelling out numbers from one through nine (or one through ninety-nine) and using numerals for larger numbers.
    </p>
    <p>
      In academic writing, the APA style recommends spelling out numbers below ten, while the Chicago Manual of Style suggests spelling out numbers below one hundred. Technical and scientific writing generally prefers numerals for precision. When beginning a sentence with a number, always spell it out regardless of size.
    </p>

    <h2>Rules for Writing Numbers in English</h2>
    <ul>
      <li>Use a hyphen for compound numbers from twenty-one through ninety-nine.</li>
      <li>Do not use "and" between hundreds and tens in American English (e.g., "one hundred one," not "one hundred and one").</li>
      <li>Use commas in numerals to separate groups of three digits (e.g., 1,000,000).</li>
      <li>Spell out numbers at the beginning of a sentence.</li>
      <li>Be consistent within a document — if spelling out one number, spell out similar numbers nearby.</li>
    </ul>

    <h2>Frequently Asked Questions</h2>

    <h3>How do you write {fmt(number)} in words?</h3>
    <p>
      {fmt(number)} in words is written as "{words}." This follows standard English number naming conventions where place values are named from largest to smallest.
    </p>

    <h3>What is the ordinal form of {fmt(number)}?</h3>
    <p>
      The ordinal form of {fmt(number)} is "{ordinal}" (written as {ordinalSuffix}). Ordinal numbers are used to indicate position in a sequence, such as rankings, dates, and addresses.
    </p>

    <h3>Is {fmt(number)} {isEven ? 'even' : 'odd'}?</h3>
    <p>
      Yes, {fmt(number)} is an {parityWord} number. {isEven ? `An even number is any integer that is divisible by 2 with no remainder. ${fmt(number)} ÷ 2 = ${fmt(number / 2)}.` : `An odd number is any integer that is not evenly divisible by 2. ${fmt(number)} ÷ 2 = ${(number / 2).toLocaleString('en-US', { maximumFractionDigits: 1 })}.`}
    </p>

    <h2>Related Numbers</h2>
    <ul>
      {relatedPages.map((p) => (
        <li>
          <a href={`/number-to-words/${p.slug}/`}>{fmt(p.number)} in Words = "{p.words}"</a>
        </li>
      ))}
    </ul>

    <p><a href="/number-to-words/">&larr; View All Numbers in Words</a> | <a href="/math-calculators/">Math Calculators</a></p>
  </article>

  <AdUnit slot="numwords-bottom" format="horizontal" />
</BaseLayout>

<style>
  .quick-fact {
    background: #eff6ff;
    border-radius: var(--radius);
    padding: 16px 24px;
    margin-bottom: 24px;
    font-size: 1.1rem;
  }
  .quick-fact-label {
    font-size: 0.85rem;
    color: var(--color-text-muted);
    display: block;
    margin-bottom: 4px;
  }
  .quick-fact strong {
    color: var(--color-primary);
    font-size: 1.3rem;
  }

  .section-heading {
    font-size: 1.2rem;
    margin: 32px 0 12px;
  }

  .facts-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 14px;
  }
  .fact-card {
    background: var(--color-bg);
    border-radius: var(--radius);
    padding: 16px 12px;
    text-align: center;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 6px;
  }
  .fact-card.primary {
    background: #eff6ff;
    grid-column: 1 / -1;
  }
  .fact-value {
    font-size: 1.2rem;
    font-weight: 700;
    color: var(--color-text);
    line-height: 1.3;
    word-break: break-word;
  }
  .fact-card.primary .fact-value {
    font-size: 1.5rem;
    color: var(--color-primary);
  }
  .fact-label {
    font-size: 0.78rem;
    font-weight: 500;
    color: var(--color-text-muted);
    text-transform: uppercase;
    letter-spacing: 0.05em;
  }

  .converter-row {
    display: flex;
    gap: 14px;
  }
  .converter-row .input-group {
    flex: 1;
  }
  .converter-result {
    margin-top: 14px;
    padding: 14px 18px;
    background: var(--color-bg);
    border-radius: var(--radius);
    font-weight: 600;
    font-size: 1.1rem;
    min-height: 48px;
    display: flex;
    align-items: center;
    word-break: break-word;
    line-height: 1.4;
  }

  @media (max-width: 640px) {
    .facts-grid {
      grid-template-columns: 1fr 1fr;
    }
    .fact-card.primary .fact-value {
      font-size: 1.2rem;
    }
    .fact-value {
      font-size: 1rem;
    }
  }
</style>

<script>
  var numInput = document.getElementById('numInput') as HTMLInputElement;
  var resultEl = document.getElementById('wordsResult') as HTMLDivElement;

  var onesArr = [
    '', 'one', 'two', 'three', 'four', 'five', 'six', 'seven', 'eight', 'nine',
    'ten', 'eleven', 'twelve', 'thirteen', 'fourteen', 'fifteen', 'sixteen',
    'seventeen', 'eighteen', 'nineteen',
  ];
  var tensArr = [
    '', '', 'twenty', 'thirty', 'forty', 'fifty', 'sixty', 'seventy', 'eighty', 'ninety',
  ];

  function toWords(n: number): string {
    if (n === 0) return 'zero';
    if (n < 0) return 'negative ' + toWords(-n);
    var result = '';
    if (n >= 1000000000) {
      result += toWords(Math.floor(n / 1000000000)) + ' billion';
      n %= 1000000000;
      if (n > 0) result += ' ';
    }
    if (n >= 1000000) {
      result += toWords(Math.floor(n / 1000000)) + ' million';
      n %= 1000000;
      if (n > 0) result += ' ';
    }
    if (n >= 1000) {
      result += toWords(Math.floor(n / 1000)) + ' thousand';
      n %= 1000;
      if (n > 0) result += ' ';
    }
    if (n >= 100) {
      result += onesArr[Math.floor(n / 100)] + ' hundred';
      n %= 100;
      if (n > 0) result += ' ';
    }
    if (n >= 20) {
      result += tensArr[Math.floor(n / 10)];
      n %= 10;
      if (n > 0) result += '-' + onesArr[n];
    } else if (n > 0) {
      result += onesArr[n];
    }
    return result;
  }

  function updateWords() {
    var num = parseInt(numInput.value, 10);
    if (isNaN(num) || num < 0 || num > 999999999999) {
      resultEl.textContent = num < 0 ? 'Enter a positive number' : 'Max: 999,999,999,999';
      return;
    }
    resultEl.textContent = toWords(num);
  }

  numInput.addEventListener('input', updateWords);
</script>
