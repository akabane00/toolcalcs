---
import BaseLayout from '../../layouts/BaseLayout.astro';
import AdUnit from '../../components/AdUnit.astro';
import '../../styles/calculator.css';
import { getAllNumberWordsPages, numberToWords, numberToOrdinal, type NumberWordsPage } from '../../data/number-to-words';

export function getStaticPaths() {
  return getAllNumberWordsPages().map((page) => ({
    params: { slug: page.slug },
    props: { page },
  }));
}

const { page } = Astro.props as { page: NumberWordsPage };
const { number, words, ordinal, ordinalSuffix, digitCount, isEven, isPrime } = page;
const capitalizedWords = words.split(' ').map(w => w.charAt(0).toUpperCase() + w.slice(1)).join(' ');
const capitalizedOrdinal = ordinal.split(' ').map(w => w.charAt(0).toUpperCase() + w.slice(1)).join(' ');

const fmt = (n: number) => n.toLocaleString('en-US');
const allPages = getAllNumberWordsPages();

// Nearby pages: +/- 5
const nearbyNumbers: NumberWordsPage[] = [];
for (let i = -5; i <= 5; i++) {
  if (i === 0) continue;
  const p = allPages.find((pg) => pg.number === number + i);
  if (p) nearbyNumbers.push(p);
}

// Related pages: +/- 5 for links section
const relatedPages = nearbyNumbers.slice();

// Place value breakdown
const placeNames = ['Ones', 'Tens', 'Hundreds', 'Thousands', 'Ten-Thousands', 'Hundred-Thousands', 'Millions', 'Ten-Millions', 'Hundred-Millions', 'Billions'];

function getPlaceValues(n: number): { position: string; digit: number; placeName: string; value: number }[] {
  if (n === 0) return [{ position: 'Ones', digit: 0, placeName: 'Ones', value: 0 }];
  const digits = String(n).split('').reverse();
  return digits.map((d, i) => ({
    position: placeNames[i] || `10^${i}`,
    digit: parseInt(d, 10),
    placeName: placeNames[i] || `10^${i}`,
    value: parseInt(d, 10) * Math.pow(10, i),
  })).reverse();
}

const placeValues = number > 0 ? getPlaceValues(number) : [];

// SEO
const title = `${fmt(number)} in Words - ${capitalizedWords} | ToolCalcs`;
const description = `${fmt(number)} in words is "${words}". The ordinal form is "${ordinal}" (${ordinalSuffix}). Learn to write numbers in English words with our converter.`;

const parityWord = isEven ? 'even' : 'odd';

const structuredData = [
  {
    "@context": "https://schema.org",
    "@type": "BreadcrumbList",
    "itemListElement": [
      { "@type": "ListItem", "position": 1, "name": "Home", "item": "https://toolcalcs.com/" },
      { "@type": "ListItem", "position": 2, "name": "Math Calculators", "item": "https://toolcalcs.com/math-calculators/" },
      { "@type": "ListItem", "position": 3, "name": `${fmt(number)} in Words` },
    ],
  },
  {
    "@context": "https://schema.org",
    "@type": "FAQPage",
    "mainEntity": [
      {
        "@type": "Question",
        "name": `How do you write ${fmt(number)} in words?`,
        "acceptedAnswer": {
          "@type": "Answer",
          "text": `${fmt(number)} in words is written as "${words}."`,
        },
      },
      {
        "@type": "Question",
        "name": `What is the ordinal form of ${fmt(number)}?`,
        "acceptedAnswer": {
          "@type": "Answer",
          "text": `The ordinal form of ${fmt(number)} is "${ordinal}" (${ordinalSuffix}).`,
        },
      },
      {
        "@type": "Question",
        "name": `Is ${fmt(number)} even or odd?`,
        "acceptedAnswer": {
          "@type": "Answer",
          "text": `${fmt(number)} is an ${parityWord} number because it ${isEven ? 'is' : 'is not'} divisible by 2.`,
        },
      },
    ],
  },
];
---

<BaseLayout title={title} description={description} type="article" structuredData={structuredData}>
  <nav class="breadcrumb">
    <a href="/">Home</a> &rsaquo;
    <a href="/math-calculators/">Math Calculators</a> &rsaquo;
    <span>{fmt(number)} in Words</span>
  </nav>

  <h1>{fmt(number)} in Words</h1>
  <p class="page-desc">Learn how to write {fmt(number)} in English words.</p>

  <!-- Quick Fact -->
  <div class="quick-fact">
    <span class="quick-fact-label">Quick Fact:</span>
    <strong>{fmt(number)} in words is "{words}"</strong>
  </div>

  <!-- Result Cards -->
  <div class="result-cards">
    <div class="result-card primary">
      <span class="result-label">In Words</span>
      <span class="result-value">{capitalizedWords}</span>
    </div>
    <div class="result-card">
      <span class="result-label">Ordinal</span>
      <span class="result-value">{capitalizedOrdinal}</span>
    </div>
    <div class="result-card">
      <span class="result-label">Ordinal Number</span>
      <span class="result-value">{ordinalSuffix}</span>
    </div>
    <div class="result-card">
      <span class="result-label">Digits</span>
      <span class="result-value">{digitCount}</span>
    </div>
    <div class="result-card">
      <span class="result-label">Even/Odd</span>
      <span class="result-value">{isEven ? 'Even' : 'Odd'}</span>
    </div>
    <div class="result-card">
      <span class="result-label">Prime/Composite</span>
      <span class="result-value">{isPrime ? 'Prime' : number === 1 ? 'Neither' : 'Composite'}</span>
    </div>
  </div>

  <!-- Place Value Breakdown -->
  {number > 0 && placeValues.length > 1 && (
    <h2 class="section-heading">Place Value Breakdown</h2>
    <div class="calculator-box">
      <table class="data-table">
        <thead>
          <tr>
            <th>Position</th>
            <th>Digit</th>
            <th>Place Value</th>
            <th>Value</th>
          </tr>
        </thead>
        <tbody>
          {placeValues.map((pv) => (
            <tr>
              <td>{pv.position}</td>
              <td>{pv.digit}</td>
              <td>{pv.placeName}</td>
              <td>{fmt(pv.value)}</td>
            </tr>
          ))}
        </tbody>
      </table>
    </div>
  )}

  <!-- Interactive Converter -->
  <h2 class="section-heading">Number to Words Converter</h2>
  <div class="calculator-box">
    <p class="calc-desc">Enter any number (up to billions) to convert it to English words.</p>
    <div class="finder-row">
      <div class="input-group">
        <label for="convertInput">Number</label>
        <input type="number" id="convertInput" value={number} min="0" max="999999999999" />
      </div>
      <button class="calc-btn" id="convertBtn">Convert to Words</button>
    </div>
    <div id="convertResult" class="finder-result"></div>
  </div>

  <!-- Nearby Numbers Table -->
  {nearbyNumbers.length > 0 && (
    <h2 class="section-heading">Nearby Numbers in Words</h2>
    <div class="table-container">
      <table class="data-table">
        <thead>
          <tr>
            <th>Number</th>
            <th>In Words</th>
          </tr>
        </thead>
        <tbody>
          {nearbyNumbers.map((p) => (
            <tr>
              <td><a href={`/number-to-words/${p.slug}/`}>{fmt(p.number)}</a></td>
              <td>{p.words}</td>
            </tr>
          ))}
        </tbody>
      </table>
    </div>
  )}

  <AdUnit slot="words-mid" format="rectangle" />

  <!-- SEO Content -->
  <article class="content-section">
    <h2>How to Write {fmt(number)} in Words</h2>
    <p>
      The number {fmt(number)} is written in English as "{words}." To write this number, break it down by place value from left to right. {digitCount > 3 ? `Since ${fmt(number)} is a ${digitCount}-digit number, separate each group of three digits and name them according to their place value (ones, thousands, millions, billions).` : `Since ${fmt(number)} is a ${digitCount}-digit number, identify each digit's place value and combine them using standard English number naming conventions.`}
    </p>
    <p>
      The ordinal form of {fmt(number)} is "{ordinal}," written in numeric shorthand as "{ordinalSuffix}." Ordinal numbers indicate position or rank in a sequence and are commonly used for dates, rankings, and floor numbers.
    </p>

    <h2>Writing Numbers in English</h2>
    <p>
      English has specific rules for writing numbers as words. Compound numbers from twenty-one through ninety-nine are always hyphenated (e.g., "twenty-one," "forty-five," "ninety-nine"). In American English, the word "and" is not used between the hundreds and tens places (e.g., "one hundred one," not "one hundred and one"), though British English commonly includes "and."
    </p>
    <p>
      For large numbers, use commas to separate groups of three digits when writing numerals (e.g., 1,000,000) and name each group according to its place value when writing words. The groups from smallest to largest are: ones, thousands, millions, billions, and trillions. Each group follows the same pattern of hundreds, tens, and ones within it.
    </p>

    <h2>When to Spell Out Numbers</h2>
    <p>
      There are several important situations where numbers should be written as words rather than digits. On checks and other financial documents, the amount must be spelled out to prevent tampering or misreading. In legal documents, numbers are typically written in both words and digits to avoid ambiguity. Formal writing, including invitations and ceremonial documents, traditionally uses words for numbers.
    </p>
    <p>
      Most style guides recommend spelling out small numbers (one through nine or one through ninety-nine, depending on the guide) and using numerals for larger numbers. Numbers at the beginning of a sentence should always be spelled out, regardless of their size. In technical and scientific writing, numerals are generally preferred for precision and readability.
    </p>

    <h2>Frequently Asked Questions</h2>

    <h3>How do you write {fmt(number)} in words?</h3>
    <p>
      {fmt(number)} in words is written as "{words}." This follows standard English number naming conventions where each group of digits is named by its place value.
    </p>

    <h3>What is the ordinal form of {fmt(number)}?</h3>
    <p>
      The ordinal form of {fmt(number)} is "{ordinal}" ({ordinalSuffix}). Ordinal numbers indicate position in a sequence, such as rankings, dates, anniversaries, and addresses.
    </p>

    <h3>Is {fmt(number)} even or odd?</h3>
    <p>
      {fmt(number)} is an {parityWord} number. {isEven ? `An even number is any integer that is exactly divisible by 2 with no remainder. Since ${fmt(number)} divided by 2 equals ${fmt(number / 2)}, it is even.` : `An odd number is any integer that is not evenly divisible by 2. Since ${fmt(number)} divided by 2 equals ${(number / 2).toLocaleString('en-US', { maximumFractionDigits: 1 })}, it is odd.`}
    </p>

    <h2>Related Numbers</h2>
    <ul>
      {relatedPages.map((p) => (
        <li>
          <a href={`/number-to-words/${p.slug}/`}>{fmt(p.number)} in Words = "{p.words}"</a>
        </li>
      ))}
    </ul>

    <p><a href="/number-to-words/">&larr; View All Numbers in Words</a> | <a href="/math-calculators/">Math Calculators</a></p>
  </article>

  <AdUnit slot="words-bottom" format="horizontal" />
</BaseLayout>

<style>
  .quick-fact {
    background: #eff6ff;
    border-radius: var(--radius);
    padding: 16px 24px;
    margin-bottom: 24px;
    font-size: 1.1rem;
  }
  .quick-fact-label {
    font-size: 0.85rem;
    color: var(--color-text-muted);
    display: block;
    margin-bottom: 4px;
  }
  .quick-fact strong {
    color: var(--color-primary);
    font-size: 1.15rem;
  }

  .section-heading {
    font-size: 1.2rem;
    margin: 32px 0 12px;
  }

  .calc-desc {
    font-size: 0.9rem;
    color: var(--color-text-muted);
    margin-bottom: 16px;
  }
  .finder-row {
    display: flex;
    gap: 16px;
    align-items: end;
    flex-wrap: wrap;
  }
  .finder-row .input-group {
    flex: 1;
    min-width: 160px;
  }
  .finder-result {
    margin-top: 16px;
    padding: 14px 16px;
    background: var(--color-bg);
    border-radius: var(--radius);
    font-size: 0.95rem;
    line-height: 1.7;
    min-height: 44px;
  }

  @media (max-width: 640px) {
    .finder-row {
      flex-direction: column;
    }
  }
</style>

<script>
  var convertInput = document.getElementById('convertInput') as HTMLInputElement;
  var convertBtn = document.getElementById('convertBtn') as HTMLButtonElement;
  var resultDiv = document.getElementById('convertResult') as HTMLDivElement;

  function numberToWords(n: number): string {
    if (n === 0) return 'zero';
    var onesArr = ['','one','two','three','four','five','six','seven','eight','nine',
      'ten','eleven','twelve','thirteen','fourteen','fifteen','sixteen','seventeen','eighteen','nineteen'];
    var tensArr = ['','','twenty','thirty','forty','fifty','sixty','seventy','eighty','ninety'];

    function convert(num: number): string {
      if (num < 20) return onesArr[num];
      if (num < 100) return tensArr[Math.floor(num/10)] + (num%10 ? '-' + onesArr[num%10] : '');
      if (num < 1000) return onesArr[Math.floor(num/100)] + ' hundred' + (num%100 ? ' ' + convert(num%100) : '');
      if (num < 1000000) return convert(Math.floor(num/1000)) + ' thousand' + (num%1000 ? ' ' + convert(num%1000) : '');
      if (num < 1000000000) return convert(Math.floor(num/1000000)) + ' million' + (num%1000000 ? ' ' + convert(num%1000000) : '');
      return convert(Math.floor(num/1000000000)) + ' billion' + (num%1000000000 ? ' ' + convert(num%1000000000) : '');
    }

    return n < 0 ? 'negative ' + convert(-n) : convert(n);
  }

  function numberToOrdinalWords(n: number): string {
    if (n === 0) return 'zeroth';
    var w = numberToWords(n);
    var ordOnes: Record<string, string> = {
      'one': 'first', 'two': 'second', 'three': 'third', 'four': 'fourth',
      'five': 'fifth', 'six': 'sixth', 'seven': 'seventh', 'eight': 'eighth',
      'nine': 'ninth', 'ten': 'tenth', 'eleven': 'eleventh', 'twelve': 'twelfth',
      'thirteen': 'thirteenth', 'fourteen': 'fourteenth', 'fifteen': 'fifteenth',
      'sixteen': 'sixteenth', 'seventeen': 'seventeenth', 'eighteen': 'eighteenth',
      'nineteen': 'nineteenth'
    };
    var ordTens: Record<string, string> = {
      'twenty': 'twentieth', 'thirty': 'thirtieth', 'forty': 'fortieth',
      'fifty': 'fiftieth', 'sixty': 'sixtieth', 'seventy': 'seventieth',
      'eighty': 'eightieth', 'ninety': 'ninetieth'
    };
    var parts = w.split(' ');
    var lastPart = parts[parts.length - 1];
    if (lastPart.includes('-')) {
      var hp = lastPart.split('-');
      var lw = hp[hp.length - 1];
      if (ordOnes[lw]) {
        hp[hp.length - 1] = ordOnes[lw];
        parts[parts.length - 1] = hp.join('-');
        return parts.join(' ');
      }
    }
    if (ordOnes[lastPart]) { parts[parts.length - 1] = ordOnes[lastPart]; return parts.join(' '); }
    if (ordTens[lastPart]) { parts[parts.length - 1] = ordTens[lastPart]; return parts.join(' '); }
    if (lastPart === 'hundred' || lastPart === 'thousand' || lastPart === 'million' || lastPart === 'billion') {
      parts[parts.length - 1] = lastPart + 'th';
      return parts.join(' ');
    }
    return w + 'th';
  }

  function getOrdinalSuffix(n: number): string {
    var j = n % 10;
    var k = n % 100;
    if (j === 1 && k !== 11) return n.toLocaleString('en-US') + 'st';
    if (j === 2 && k !== 12) return n.toLocaleString('en-US') + 'nd';
    if (j === 3 && k !== 13) return n.toLocaleString('en-US') + 'rd';
    return n.toLocaleString('en-US') + 'th';
  }

  function doConvert() {
    var n = parseInt(convertInput.value, 10);
    if (isNaN(n) || n < 0 || n > 999999999999) {
      resultDiv.textContent = 'Please enter a number between 0 and 999,999,999,999.';
      return;
    }
    var w = numberToWords(n);
    var ord = numberToOrdinalWords(n);
    var ordSuf = getOrdinalSuffix(n);

    var html = '<strong>In Words:</strong> ' + w;
    html += '<br><strong>Ordinal:</strong> ' + ord;
    html += '<br><strong>Ordinal Number:</strong> ' + ordSuf;
    resultDiv.innerHTML = html;
  }

  convertBtn.addEventListener('click', doConvert);
  convertInput.addEventListener('keydown', function(e) {
    if ((e as KeyboardEvent).key === 'Enter') doConvert();
  });

  doConvert();
</script>
