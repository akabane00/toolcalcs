---
import BaseLayout from '../../layouts/BaseLayout.astro';
import AdUnit from '../../components/AdUnit.astro';
import CrossLinks from '../../components/CrossLinks.astro';
import '../../styles/calculator.css';
import { getAllSalaryPages, type SalaryPage } from '../../data/salary-conversions';

export function getStaticPaths() {
  return getAllSalaryPages().map((page) => ({
    params: { slug: page.slug },
    props: { page },
  }));
}

const { page } = Astro.props as { page: SalaryPage };
const { slug, direction, hourlyRate, annualSalary, monthlySalary, biweeklySalary, weeklySalary, dailySalary, overtimeRate, afterTaxAnnual, afterTaxMonthly, afterTaxBiweekly } = page;

function fmt(n: number): string {
  return '$' + n.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
}

const isHourly = direction === 'hourly';
const allPages = getAllSalaryPages();

// H1 and title
const h1 = isHourly
  ? `$${hourlyRate} an Hour is How Much a Year?`
  : `$${annualSalary.toLocaleString()} a Year is How Much an Hour?`;

const title = isHourly
  ? `$${hourlyRate} an Hour is How Much a Year? (${fmt(annualSalary)}) | ToolCalcs`
  : `$${annualSalary.toLocaleString()} a Year is How Much an Hour? (${fmt(hourlyRate)}) | ToolCalcs`;

const description = isHourly
  ? `$${hourlyRate} an hour is ${fmt(annualSalary)} a year, ${fmt(monthlySalary)} a month, and ${fmt(biweeklySalary)} biweekly before taxes. After taxes: ~${fmt(afterTaxAnnual)}/year.`
  : `$${annualSalary.toLocaleString()} a year is ${fmt(hourlyRate)} an hour, ${fmt(monthlySalary)} a month, and ${fmt(biweeklySalary)} biweekly. After taxes: ~${fmt(afterTaxAnnual)}/year.`;

const breadcrumbShort = isHourly ? `$${hourlyRate}/hr Salary` : `$${annualSalary.toLocaleString()}/yr Salary`;

// Quick Fact
const quickFact = isHourly
  ? `$${hourlyRate}/hour = ${fmt(annualSalary)}/year (before taxes)`
  : `${fmt(annualSalary)}/year = ${fmt(hourlyRate)}/hour (based on 2,080 work hours)`;

// Comparison table: +-5 neighbors from same direction
const sameDirection = allPages.filter((p) => p.direction === direction);
const currentIndex = sameDirection.findIndex((p) => p.slug === slug);
const neighborStart = Math.max(0, currentIndex - 5);
const neighborEnd = Math.min(sameDirection.length, currentIndex + 6);
const comparisonPages = sameDirection.slice(neighborStart, neighborEnd).filter((p) => p.slug !== slug);

// Related pages: nearby from same direction
const relatedPages = allPages
  .filter((p) => p.direction === direction && p.slug !== slug)
  .sort((a, b) => Math.abs(a.hourlyRate - hourlyRate) - Math.abs(b.hourlyRate - hourlyRate))
  .slice(0, 6);

// Context paragraph
function getSalaryContext(annual: number): string {
  if (annual < 30000) return `An annual salary of ${fmt(annual)} is below the median individual income in the United States. At this income level, budgeting carefully and minimizing fixed expenses is especially important. Many workers at this pay level supplement their income with overtime, side jobs, or seek positions with benefits like health insurance and retirement contributions.`;
  if (annual < 50000) return `An annual salary of ${fmt(annual)} is near the U.S. median individual income. At this level, most workers can cover essential living expenses in many areas of the country, though high-cost cities may present challenges. Contributing to employer-matched retirement plans and building an emergency fund are smart financial priorities at this income.`;
  if (annual < 80000) return `An annual salary of ${fmt(annual)} is above the U.S. median individual income. At this income level, most workers can comfortably cover living expenses in the majority of U.S. cities. This is a good income range for building savings, investing, and making progress toward long-term financial goals like homeownership and retirement.`;
  if (annual < 120000) return `An annual salary of ${fmt(annual)} places you well above the median income. This income level provides financial flexibility in most parts of the country. Workers earning at this level typically have the capacity to save aggressively, invest in diversified portfolios, and pursue major financial milestones ahead of schedule.`;
  return `An annual salary of ${fmt(annual)} is a high income that places you in the upper percentiles of U.S. earners. At this level, tax planning becomes increasingly important, as you may be subject to higher marginal rates. Consider maximizing tax-advantaged accounts, diversifying investments, and consulting a financial advisor to optimize your overall financial strategy.`;
}

// FAQ content
const faq1Q = isHourly
  ? `$${hourlyRate} an hour is how much a year?`
  : `$${annualSalary.toLocaleString()} a year is how much an hour?`;
const faq1A = isHourly
  ? `$${hourlyRate} an hour is ${fmt(annualSalary)} a year before taxes, based on working 40 hours per week for 52 weeks (2,080 total hours).`
  : `$${annualSalary.toLocaleString()} a year is ${fmt(hourlyRate)} an hour, based on 2,080 working hours per year (40 hours per week times 52 weeks).`;

const faq2Q = isHourly
  ? `${fmt(annualSalary)} a year is how much an hour?`
  : `${fmt(hourlyRate)} an hour is how much a year?`;
const faq2A = isHourly
  ? `${fmt(annualSalary)} a year equals ${fmt(hourlyRate)} per hour, dividing the annual salary by 2,080 work hours.`
  : `${fmt(hourlyRate)} an hour equals ${fmt(annualSalary)} per year, multiplying the hourly rate by 2,080 work hours.`;

const faq3Q = `How much is $${isHourly ? hourlyRate + '/hour' : annualSalary.toLocaleString() + '/year'} after taxes?`;
const faq3A = `At ${fmt(annualSalary)} per year, estimated take-home pay after federal taxes and FICA is approximately ${fmt(afterTaxAnnual)} per year. Actual results vary by state, deductions, and filing status.`;

const faq4Q = `How is overtime pay calculated?`;
const faq4A = `Overtime pay is typically 1.5 times the regular hourly rate. At ${fmt(hourlyRate)}/hour, the overtime rate is ${fmt(overtimeRate)}/hour.`;

// Structured Data
const structuredData = [
  {
    "@context": "https://schema.org",
    "@type": "BreadcrumbList",
    "itemListElement": [
      { "@type": "ListItem", "position": 1, "name": "Home", "item": "https://toolcalcs.com/" },
      { "@type": "ListItem", "position": 2, "name": "Financial Calculators", "item": "https://toolcalcs.com/financial-calculators/" },
      { "@type": "ListItem", "position": 3, "name": breadcrumbShort },
    ],
  },
  {
    "@context": "https://schema.org",
    "@type": "FAQPage",
    "mainEntity": [
      {
        "@type": "Question",
        "name": faq1Q,
        "acceptedAnswer": { "@type": "Answer", "text": faq1A },
      },
      {
        "@type": "Question",
        "name": faq2Q,
        "acceptedAnswer": { "@type": "Answer", "text": faq2A },
      },
      {
        "@type": "Question",
        "name": faq3Q,
        "acceptedAnswer": { "@type": "Answer", "text": faq3A },
      },
      {
        "@type": "Question",
        "name": faq4Q,
        "acceptedAnswer": { "@type": "Answer", "text": faq4A },
      },
    ],
  },
];
---

<BaseLayout title={title} description={description} type="article" structuredData={structuredData}>
  <nav class="breadcrumb">
    <a href="/">Home</a> &rsaquo;
    <a href="/financial-calculators/">Financial Calculators</a> &rsaquo;
    <span>{breadcrumbShort}</span>
  </nav>

  <h1>{h1}</h1>
  <p class="page-desc">
    {isHourly
      ? `See what $${hourlyRate} per hour adds up to annually, monthly, biweekly, and weekly â€” before and after taxes.`
      : `See what $${annualSalary.toLocaleString()} per year breaks down to hourly, monthly, biweekly, and weekly â€” before and after taxes.`
    }
  </p>

  <!-- Quick Fact -->
  <div class="quick-fact">
    <span class="quick-fact-label">Quick Fact:</span>
    <strong>{quickFact}</strong>
  </div>

  <!-- Result Cards -->
  <div class="result-cards">
    <div class="result-card primary">
      <span class="result-label">Annual Salary</span>
      <span class="result-value">{fmt(annualSalary)}</span>
    </div>
    <div class="result-card">
      <span class="result-label">Monthly</span>
      <span class="result-value">{fmt(monthlySalary)}</span>
    </div>
    <div class="result-card">
      <span class="result-label">Biweekly</span>
      <span class="result-value">{fmt(biweeklySalary)}</span>
    </div>
    <div class="result-card">
      <span class="result-label">Weekly</span>
      <span class="result-value">{fmt(weeklySalary)}</span>
    </div>
    <div class="result-card">
      <span class="result-label">Daily (8h)</span>
      <span class="result-value">{fmt(dailySalary)}</span>
    </div>
    <div class="result-card">
      <span class="result-label">Overtime Rate (1.5x)</span>
      <span class="result-value">{fmt(overtimeRate)}</span>
    </div>
  </div>

  <!-- After-Tax Section -->
  <div class="calculator-box">
    <h2 class="calc-section-title">Estimated Take-Home Pay (After Tax)</h2>
    <div class="disclaimer">
      Estimates based on simplified 2025 federal tax brackets (single filer) + FICA. Actual taxes vary by state, deductions, and filing status.
    </div>
    <div class="result-cards">
      <div class="result-card">
        <span class="result-label">After-Tax Annual</span>
        <span class="result-value">{fmt(afterTaxAnnual)}</span>
      </div>
      <div class="result-card">
        <span class="result-label">After-Tax Monthly</span>
        <span class="result-value">{fmt(afterTaxMonthly)}</span>
      </div>
      <div class="result-card">
        <span class="result-label">After-Tax Biweekly</span>
        <span class="result-value">{fmt(afterTaxBiweekly)}</span>
      </div>
    </div>
  </div>

  <!-- Interactive Calculator -->
  <h2 class="section-heading">Salary Calculator</h2>
  <div class="calculator-box">
    <p class="calc-desc">Enter an hourly rate or annual salary to convert between pay periods.</p>
    <div class="finder-row">
      <div class="input-group">
        <label for="hourlyInput">Hourly Rate ($)</label>
        <input type="number" id="hourlyInput" value={hourlyRate} step="0.01" min="0" />
      </div>
      <div class="input-group">
        <label for="annualInput">Annual Salary ($)</label>
        <input type="number" id="annualInput" value={annualSalary} step="100" min="0" />
      </div>
      <button class="calc-btn" id="convertBtn">Convert</button>
    </div>
    <div id="calcResult" class="finder-result"></div>
  </div>

  <!-- Comparison Table -->
  {comparisonPages.length > 0 && (
    <h2 class="section-heading">{isHourly ? 'Nearby Hourly Rates' : 'Nearby Annual Salaries'}</h2>
    <div class="table-container">
      <table class="data-table">
        <thead>
          <tr>
            <th>Hourly</th>
            <th>Annual</th>
            <th>Monthly</th>
            <th>Weekly</th>
          </tr>
        </thead>
        <tbody>
          {comparisonPages.map((p) => (
            <tr>
              <td><a href={`/salary/${p.slug}/`}>{fmt(p.hourlyRate)}</a></td>
              <td>{fmt(p.annualSalary)}</td>
              <td>{fmt(p.monthlySalary)}</td>
              <td>{fmt(p.weeklySalary)}</td>
            </tr>
          ))}
        </tbody>
      </table>
    </div>
  )}

  <AdUnit slot="salary-mid" format="rectangle" />

  <!-- SEO Content -->
  <article class="content-section">
    <h2>How to Calculate {isHourly ? 'Annual Salary from Hourly Rate' : 'Hourly Rate from Annual Salary'}</h2>
    <p>
      {isHourly
        ? `To calculate your annual salary from an hourly wage, multiply your hourly rate by the number of hours you work per year. The standard full-time schedule is 40 hours per week for 52 weeks, which equals 2,080 working hours per year. For $${hourlyRate} per hour: $${hourlyRate} x 2,080 = ${fmt(annualSalary)}.`
        : `To calculate your hourly rate from an annual salary, divide your annual salary by the total number of working hours in a year. Using the standard 2,080 hours (40 hours per week times 52 weeks): $${annualSalary.toLocaleString()} / 2,080 = ${fmt(hourlyRate)} per hour.`
      }
    </p>
    <p>
      This formula assumes full-time employment without unpaid time off. If you work fewer weeks per year or different hours per week, adjust accordingly. For example, working 50 weeks instead of 52 at {fmt(hourlyRate)}/hour would yield {fmt(hourlyRate * 40 * 50)}/year.
    </p>

    <h2>Understanding Your Take-Home Pay</h2>
    <p>
      Your take-home pay is your gross salary minus all tax deductions. At {fmt(annualSalary)} per year, estimated federal income tax and FICA (Social Security at 6.2% and Medicare at 1.45%) reduce your pay to approximately {fmt(afterTaxAnnual)} annually, or {fmt(afterTaxMonthly)} per month.
    </p>
    <p>
      These estimates use simplified 2025 federal tax brackets for a single filer with the standard deduction. Your actual take-home pay may differ based on your state of residence, filing status (married, head of household), number of dependents, pre-tax deductions (401k, health insurance), and any applicable tax credits. State income taxes range from 0% in states like Texas and Florida to over 13% in California.
    </p>

    <h2>Can You Live on {isHourly ? `$${hourlyRate} an Hour` : `$${annualSalary.toLocaleString()} a Year`}?</h2>
    <p>
      {getSalaryContext(annualSalary)}
    </p>

    <h2>Frequently Asked Questions</h2>

    <h3>{faq1Q}</h3>
    <p>{faq1A}</p>

    <h3>{faq2Q}</h3>
    <p>{faq2A}</p>

    <h3>{faq3Q}</h3>
    <p>{faq3A}</p>

    <h3>{faq4Q}</h3>
    <p>{faq4A}</p>

    <h2>Related Salary Pages</h2>
    <ul>
      {relatedPages.map((p) => (
        <li>
          <a href={`/salary/${p.slug}/`}>
            {p.direction === 'hourly'
              ? `$${p.hourlyRate} an Hour = ${fmt(p.annualSalary)}/year`
              : `$${p.annualSalary.toLocaleString()} a Year = ${fmt(p.hourlyRate)}/hour`
            }
          </a>
        </li>
      ))}
    </ul>

    <p><a href="/salary/">&larr; View All Salary Conversions</a> | <a href="/financial-calculators/">Financial Calculators</a></p>

    <CrossLinks links={[
      { href: '/tip/', label: 'Tip Calculator', icon: 'ðŸ½ï¸' },
      { href: '/percentage/', label: 'Percentage Calculator', icon: '%' },
      { href: '/currency/', label: 'Currency Converter', icon: 'ðŸ’±' },
    ]} />
  </article>

  <AdUnit slot="salary-bottom" format="horizontal" />
</BaseLayout>

<style>
  .quick-fact {
    background: #eff6ff;
    border-radius: var(--radius);
    padding: 16px 24px;
    margin-bottom: 24px;
    font-size: 1.1rem;
  }
  .quick-fact-label {
    font-size: 0.85rem;
    color: var(--color-text-muted);
    display: block;
    margin-bottom: 4px;
  }
  .quick-fact strong {
    color: var(--color-primary);
    font-size: 1.15rem;
  }

  .calc-section-title {
    font-size: 1.15rem;
    margin: 0 0 16px;
    border: none;
    padding: 0;
  }
  .section-heading {
    font-size: 1.2rem;
    margin: 32px 0 12px;
  }

  .disclaimer {
    background: #fef3c7;
    border-radius: var(--radius);
    padding: 10px 16px;
    font-size: 0.85rem;
    color: #92400e;
    margin-bottom: 16px;
    line-height: 1.5;
  }

  .calc-desc {
    font-size: 0.9rem;
    color: var(--color-text-muted);
    margin-bottom: 16px;
  }
  .finder-row {
    display: flex;
    gap: 16px;
    align-items: end;
    flex-wrap: wrap;
  }
  .finder-row .input-group {
    flex: 1;
    min-width: 160px;
  }
  .finder-result {
    margin-top: 16px;
    padding: 14px 16px;
    background: var(--color-bg);
    border-radius: var(--radius);
    font-size: 0.95rem;
    line-height: 1.7;
    min-height: 44px;
  }

  @media (max-width: 640px) {
    .finder-row {
      flex-direction: column;
    }
    .result-cards {
      grid-template-columns: 1fr;
    }
  }
</style>

<script define:vars={{ defaultRate: hourlyRate }}>
  var hourlyInput = document.getElementById('hourlyInput');
  var annualInput = document.getElementById('annualInput');
  var convertBtn = document.getElementById('convertBtn');
  var resultDiv = document.getElementById('calcResult');
  var lastEdited = 'hourly';

  hourlyInput.addEventListener('input', function() { lastEdited = 'hourly'; });
  annualInput.addEventListener('input', function() { lastEdited = 'annual'; });

  function fmtNum(n) {
    return '$' + n.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
  }

  function doConvert() {
    var rate, annual;
    if (lastEdited === 'hourly') {
      rate = parseFloat(hourlyInput.value);
      if (isNaN(rate) || rate < 0) { resultDiv.textContent = 'Please enter a valid hourly rate.'; return; }
      annual = rate * 2080;
      annualInput.value = annual.toFixed(0);
    } else {
      annual = parseFloat(annualInput.value);
      if (isNaN(annual) || annual < 0) { resultDiv.textContent = 'Please enter a valid annual salary.'; return; }
      rate = annual / 2080;
      hourlyInput.value = rate.toFixed(2);
    }

    var monthly = annual / 12;
    var biweekly = annual / 26;
    var weekly = rate * 40;
    var daily = rate * 8;
    var overtime = rate * 1.5;

    var html = '<strong>Annual:</strong> ' + fmtNum(annual);
    html += ' | <strong>Monthly:</strong> ' + fmtNum(monthly);
    html += ' | <strong>Biweekly:</strong> ' + fmtNum(biweekly);
    html += '<br><strong>Weekly:</strong> ' + fmtNum(weekly);
    html += ' | <strong>Daily (8h):</strong> ' + fmtNum(daily);
    html += ' | <strong>Overtime (1.5x):</strong> ' + fmtNum(overtime);

    resultDiv.innerHTML = html;
  }

  convertBtn.addEventListener('click', doConvert);
  hourlyInput.addEventListener('keydown', function(e) { if (e.key === 'Enter') doConvert(); });
  annualInput.addEventListener('keydown', function(e) { if (e.key === 'Enter') doConvert(); });

  doConvert();
</script>
