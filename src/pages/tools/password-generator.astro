---
import BaseLayout from '../../layouts/BaseLayout.astro';
import AdUnit from '../../components/AdUnit.astro';
import { getToolBySlug } from '../../data/tools';
import '../../styles/tool.css';

const tool = getToolBySlug('password-generator')!;

const structuredData = [
  {
    "@context": "https://schema.org",
    "@type": "BreadcrumbList",
    "itemListElement": [
      {
        "@type": "ListItem",
        "position": 1,
        "name": "Home",
        "item": "https://toolcalcs.com/"
      },
      {
        "@type": "ListItem",
        "position": 2,
        "name": "Web Tools",
        "item": "https://toolcalcs.com/tools/"
      },
      {
        "@type": "ListItem",
        "position": 3,
        "name": "Password Generator"
      }
    ]
  },
  {
    '@context': 'https://schema.org',
    '@type': 'FAQPage',
    mainEntity: [
      {
        '@type': 'Question',
        name: 'How does this password generator create secure passwords?',
        acceptedAnswer: {
          '@type': 'Answer',
          text: 'This password generator uses the Web Crypto API (crypto.getRandomValues) to produce cryptographically secure random numbers. Unlike Math.random(), which uses a pseudo-random algorithm unsuitable for security purposes, crypto.getRandomValues draws from the operating system\'s entropy pool, making the generated passwords unpredictable and safe for use in authentication systems, encryption keys, and other security-sensitive contexts.',
        },
      },
      {
        '@type': 'Question',
        name: 'What is password entropy and why does it matter?',
        acceptedAnswer: {
          '@type': 'Answer',
          text: 'Password entropy is a measure of how unpredictable a password is, expressed in bits. It is calculated as log2(charsetSize^length), where charsetSize is the number of possible characters and length is the password length. Higher entropy means more possible combinations an attacker would need to try. A password with 40 bits of entropy has about 1 trillion possible combinations, while 80 bits of entropy has over 1 septillion combinations. Security experts generally recommend a minimum of 60 bits of entropy for important accounts and 80 or more bits for critical systems.',
        },
      },
      {
        '@type': 'Question',
        name: 'What makes a password strong?',
        acceptedAnswer: {
          '@type': 'Answer',
          text: 'A strong password combines length and character diversity. Using uppercase letters, lowercase letters, numbers, and symbols maximizes the character set size, which increases entropy per character. However, length is the single most important factor. A 20-character password using only lowercase letters (about 94 bits of entropy) is stronger than an 8-character password using all character types (about 52 bits). The ideal approach is to use both long passwords and diverse character sets.',
        },
      },
    ],
  },
];
---

<BaseLayout
  title="Password Generator - Create Strong Secure Passwords | ToolCalcs"
  description="Generate strong, secure random passwords with customizable length and character types. Uses cryptographic randomness for maximum security. Check password strength instantly."
  type="article"
  structuredData={structuredData}
>
  <nav class="breadcrumb">
    <a href="/">Home</a> &rsaquo;
    <a href="/tools/">Web Tools</a> &rsaquo;
    <span>Password Generator</span>
  </nav>

  <h1>{tool.title}</h1>
  <p class="page-desc">{tool.description}</p>

  <div class="tool-box">
    <div class="password-display-wrapper">
      <output class="password-display" id="passwordOutput" aria-live="polite">Generating...</output>
      <button class="copy-btn" id="copyInlineBtn" type="button" title="Copy password to clipboard">Copy</button>
    </div>

    <div class="strength-label" id="strengthLabel">Checking...</div>
    <div class="strength-meter" id="strengthMeter" role="meter" aria-label="Password strength">
      <div class="strength-bar" id="bar1"></div>
      <div class="strength-bar" id="bar2"></div>
      <div class="strength-bar" id="bar3"></div>
      <div class="strength-bar" id="bar4"></div>
    </div>
    <div class="entropy-label" id="entropyLabel"></div>

    <div class="tool-options">
      <div class="tool-option length-option">
        <label for="lengthSlider">Length: <span id="lengthValue">16</span></label>
        <input type="range" id="lengthSlider" min="8" max="128" value="16" />
      </div>
      <div class="tool-option checkbox-option">
        <label class="checkbox-label">
          <input type="checkbox" id="optUppercase" checked />
          <span>Uppercase (A-Z)</span>
        </label>
      </div>
      <div class="tool-option checkbox-option">
        <label class="checkbox-label">
          <input type="checkbox" id="optLowercase" checked />
          <span>Lowercase (a-z)</span>
        </label>
      </div>
      <div class="tool-option checkbox-option">
        <label class="checkbox-label">
          <input type="checkbox" id="optNumbers" checked />
          <span>Numbers (0-9)</span>
        </label>
      </div>
      <div class="tool-option checkbox-option">
        <label class="checkbox-label">
          <input type="checkbox" id="optSymbols" checked />
          <span>Symbols (!@#$...)</span>
        </label>
      </div>
    </div>

    <div class="tool-controls">
      <button class="tool-btn primary" id="generateBtn" type="button">Generate New</button>
      <button class="tool-btn secondary" id="copyBtn" type="button">Copy to Clipboard</button>
    </div>
  </div>

  <AdUnit slot="tool-mid" format="rectangle" />

  <article class="content-section">
    <h2>Why Strong Passwords Matter</h2>
    <p>Passwords remain the primary line of defense for protecting your digital accounts, personal information, and financial assets. Despite advances in biometric authentication and passkeys, the vast majority of online services still rely on passwords as their core authentication mechanism. A weak password is the equivalent of leaving your front door unlocked in a busy neighborhood. Cybercriminals use automated tools that can test billions of password combinations per second, making short or predictable passwords trivially easy to crack.</p>
    <p>Data breaches expose millions of credentials every year. When attackers gain access to a password database, they use specialized hardware and software to crack the hashed passwords as quickly as possible. Passwords like "123456," "password," and "qwerty" are cracked instantly because they appear in every common password dictionary. Even seemingly clever substitutions like "p@ssw0rd" or "admin123" are well-known to attackers and offer virtually no additional protection. The only reliable defense is a password that is long, random, and unique to each account.</p>
    <p>The consequences of a compromised password extend far beyond a single account. Attackers routinely use a technique called credential stuffing, where stolen username-password pairs from one breach are automatically tested against hundreds of other websites. If you reuse the same password across multiple services, a single breach can cascade into the compromise of your email, banking, social media, and cloud storage accounts. This is why using a unique, randomly generated password for every account is not just a best practice but a necessity for digital security.</p>

    <h2>Understanding Password Entropy</h2>
    <p>Password entropy is the mathematical measure of how unpredictable a password is, expressed in bits. It quantifies the number of guesses an attacker would need to try, on average, to crack the password through brute force. The formula is straightforward: entropy equals the logarithm base 2 of the character set size raised to the power of the password length, or <strong>E = log2(C^L)</strong>, where C is the number of possible characters and L is the password length.</p>
    <p>To put this in practical terms, consider a password that uses only lowercase letters (26 possible characters). An 8-character password from this set has about 37.6 bits of entropy, meaning there are roughly 209 billion possible combinations. That sounds impressive until you learn that modern GPU-based cracking rigs can test over 100 billion hashes per second for common algorithms like MD5. Your 37.6-bit password would fall in about two seconds.</p>
    <p>Now consider a 16-character password using uppercase letters, lowercase letters, digits, and symbols, giving a character set of 95. This password has about 105 bits of entropy, representing approximately 4.4 times 10 to the 31st power possible combinations. At 100 billion guesses per second, cracking this password would take longer than the age of the universe. This dramatic difference illustrates why both length and character diversity matter enormously. Each additional character multiplies the total number of combinations by the size of the character set, making the password exponentially harder to crack.</p>

    <h2>How This Generator Works</h2>
    <p>This password generator uses the Web Crypto API, specifically the <code>crypto.getRandomValues()</code> method, to produce cryptographically secure random numbers. Unlike <code>Math.random()</code>, which uses a deterministic pseudo-random number generator that can be predicted if the internal state is known, the Web Crypto API draws randomness from the operating system's entropy pool. This entropy pool collects unpredictable data from hardware events such as mouse movements, keyboard timings, disk activity, and network packet arrival times, ensuring that the generated values are truly unpredictable.</p>
    <p>The generation process works as follows. First, the tool determines which character sets to include based on your selected options: uppercase letters A through Z, lowercase letters a through z, digits 0 through 9, and symbols including <code>!@#$%^&amp;*()_+-=[]{}|;:,.&lt;&gt;?</code>. It then ensures that at least one character from each selected set appears in the final password, preventing the unlikely but possible scenario where a random selection omits an entire character category. The remaining positions are filled with characters chosen uniformly at random from the combined character pool. Finally, the password characters are shuffled using a cryptographically secure variant of the Fisher-Yates algorithm to eliminate any positional bias introduced by the guaranteed character requirement.</p>
    <p>All processing happens entirely in your browser. No passwords are transmitted over the network, stored on any server, or logged anywhere. You can verify this by disconnecting from the internet and confirming that the generator continues to work. This client-side architecture ensures that your generated passwords remain completely private.</p>

    <h2>Password Security Best Practices</h2>
    <p><strong>Use a unique password for every account.</strong> This is the single most important rule of password security. If you reuse passwords, a breach at one service compromises every other service using the same credentials. A password manager makes this practical by storing and auto-filling unique passwords so you only need to remember one master password.</p>
    <p><strong>Make passwords at least 16 characters long.</strong> Length is the most powerful factor in password strength. Each additional character multiplies the number of possible combinations by the size of the character set. A 16-character password with mixed character types provides over 100 bits of entropy, which is resistant to brute-force attacks for the foreseeable future. For critical accounts like email and banking, consider 20 characters or more.</p>
    <p><strong>Enable two-factor authentication (2FA) wherever possible.</strong> Even the strongest password can be compromised through phishing, malware, or server-side breaches. Two-factor authentication adds a second layer of protection by requiring something you have, such as a phone or hardware security key, in addition to something you know. Hardware security keys like YubiKey offer the strongest protection against phishing attacks, followed by authenticator apps. SMS-based 2FA, while better than no 2FA, is vulnerable to SIM-swapping attacks.</p>
    <p><strong>Never share passwords through email, text, or chat.</strong> These communication channels are not designed for transmitting sensitive information and may be intercepted, stored in logs, or visible to administrators. If you need to share access to an account, use the service's built-in sharing features or a password manager's secure sharing function. If you must transmit a password, use a separate secure channel and change it afterward.</p>
    <p><strong>Watch for phishing attempts.</strong> The most common way passwords are stolen is through phishing, where attackers create convincing fake login pages to trick you into entering your credentials. Always verify the URL before entering a password, be suspicious of unexpected login prompts, and never click links in unsolicited emails asking you to "verify" or "update" your account information. A password manager helps defend against phishing because it will not auto-fill credentials on a fake domain.</p>

    <h2>Common Password Attacks</h2>
    <p><strong>Brute-force attacks</strong> systematically try every possible combination of characters until the correct password is found. The time required depends on the password length, character set size, and the attacker's computational resources. Modern GPU clusters can test billions of password candidates per second against common hashing algorithms. Brute-force attacks are guaranteed to succeed eventually, but strong passwords make the required time astronomically long, effectively rendering the attack impractical.</p>
    <p><strong>Dictionary attacks</strong> use lists of common passwords, English words, names, dates, and known patterns to guess passwords. These lists, compiled from previous data breaches, contain billions of entries. Dictionary attacks are extremely effective because a large percentage of real-world passwords are based on dictionary words or common patterns. A randomly generated password is immune to dictionary attacks because it does not contain recognizable words or patterns.</p>
    <p><strong>Credential stuffing</strong> is an automated attack where stolen username-password pairs from one data breach are tested against other websites. Attackers exploit the widespread habit of password reuse, and success rates typically range from 0.1% to 2%, which translates to thousands or millions of compromised accounts when applied at scale. Using unique passwords for every account eliminates this attack vector entirely.</p>
    <p><strong>Rainbow table attacks</strong> use precomputed tables that map hash values back to their plaintext passwords. These tables trade computation time for storage space, allowing attackers to look up a hash and find its corresponding password almost instantly. Modern password storage systems defend against rainbow tables by using salt, a random value added to each password before hashing, ensuring that identical passwords produce different hash values.</p>

    <h2>Frequently Asked Questions</h2>
    <h3>How does this password generator create secure passwords?</h3>
    <p>This password generator uses the Web Crypto API (<code>crypto.getRandomValues</code>) to produce cryptographically secure random numbers. Unlike <code>Math.random()</code>, which uses a pseudo-random algorithm unsuitable for security purposes, <code>crypto.getRandomValues</code> draws from the operating system's entropy pool, making the generated passwords unpredictable and safe for use in authentication systems, encryption keys, and other security-sensitive contexts. All generation happens in your browser, and no passwords are sent to any server.</p>

    <h3>What is password entropy and why does it matter?</h3>
    <p>Password entropy is a measure of how unpredictable a password is, expressed in bits. It is calculated as log2(charsetSize^length), where charsetSize is the number of possible characters and length is the password length. Higher entropy means more possible combinations an attacker would need to try in a brute-force attack. A password with 40 bits of entropy has about 1 trillion possible combinations, while 80 bits of entropy has over 1 septillion combinations. Security experts generally recommend a minimum of 60 bits of entropy for important accounts and 80 or more bits for critical systems like email and banking.</p>

    <h3>What makes a password strong?</h3>
    <p>A strong password combines length and character diversity. Using uppercase letters, lowercase letters, numbers, and symbols maximizes the character set size, which increases entropy per character. However, length is the single most important factor. A 20-character password using only lowercase letters has about 94 bits of entropy, which is stronger than an 8-character password using all character types at about 52 bits. The ideal approach is to use both long passwords and diverse character sets, which is exactly what this generator produces by default.</p>

    <h2>Related Tools</h2>
    <ul>
      <li><a href="/tools/base64-encoder-decoder/">Base64 Encoder/Decoder</a> - Encode and decode Base64 strings.</li>
      <li><a href="/tools/json-formatter/">JSON Formatter</a> - Format, validate, and minify JSON data.</li>
      <li><a href="/math-calculators/random-number-generator/">Random Number Generator</a> - Generate random numbers within any range.</li>
    </ul>
  </article>

  <AdUnit slot="tool-bottom" format="horizontal" />
</BaseLayout>

<style>
  .password-display-wrapper {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 16px;
    background: var(--color-bg);
    border: 1px solid var(--color-border);
    border-radius: var(--radius);
    margin-bottom: 12px;
  }
  .password-display {
    flex: 1;
    font-family: 'Courier New', Consolas, monospace;
    font-size: 1.25rem;
    font-weight: 600;
    word-break: break-all;
    line-height: 1.5;
    color: var(--color-text);
    user-select: all;
    -webkit-user-select: all;
    min-height: 1.5em;
  }

  .entropy-label {
    font-size: 0.8rem;
    color: var(--color-text-muted);
    margin-bottom: 16px;
  }

  .tool-options {
    padding-top: 16px;
    border-top: 1px solid var(--color-border);
  }

  .length-option {
    flex: 1 1 100%;
  }
  .length-option label {
    display: flex;
    gap: 4px;
    margin-bottom: 4px;
  }
  .length-option input[type="range"] {
    width: 100%;
    padding: 0;
    cursor: pointer;
    accent-color: var(--color-primary);
  }

  .checkbox-option {
    flex-direction: row !important;
    align-items: center;
  }
  .checkbox-label {
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 0.9rem;
    cursor: pointer;
    white-space: nowrap;
    font-weight: 400;
    color: var(--color-text);
  }
  .checkbox-label input[type="checkbox"] {
    width: 18px;
    height: 18px;
    cursor: pointer;
    accent-color: var(--color-primary);
  }

  @media (max-width: 640px) {
    .password-display {
      font-size: 1rem;
    }
    .password-display-wrapper {
      flex-direction: column;
      align-items: stretch;
    }
    .password-display-wrapper .copy-btn {
      align-self: flex-end;
    }
  }
</style>

<script is:inline>
  var CHARSETS = {
    uppercase: 'ABCDEFGHIJKLMNOPQRSTUVWXYZ',
    lowercase: 'abcdefghijklmnopqrstuvwxyz',
    numbers: '0123456789',
    symbols: '!@#$%^&*()_+-=[]{}|;:,.<>?'
  };

  function secureRandomIndex(max) {
    // Rejection sampling to avoid modulo bias
    var array = new Uint32Array(1);
    var limit = Math.floor(4294967296 / max) * max;
    do {
      crypto.getRandomValues(array);
    } while (array[0] >= limit);
    return array[0] % max;
  }

  function secureShuffle(arr) {
    // Fisher-Yates shuffle using crypto random
    for (var i = arr.length - 1; i > 0; i--) {
      var j = secureRandomIndex(i + 1);
      var tmp = arr[i];
      arr[i] = arr[j];
      arr[j] = tmp;
    }
    return arr;
  }

  function getSelectedSets() {
    var sets = [];
    if (document.getElementById('optUppercase').checked) sets.push('uppercase');
    if (document.getElementById('optLowercase').checked) sets.push('lowercase');
    if (document.getElementById('optNumbers').checked) sets.push('numbers');
    if (document.getElementById('optSymbols').checked) sets.push('symbols');
    return sets;
  }

  function generatePassword() {
    var selectedSets = getSelectedSets();

    if (selectedSets.length === 0) {
      document.getElementById('passwordOutput').textContent = 'Select at least one character type';
      updateStrength(0, 0);
      return;
    }

    var length = parseInt(document.getElementById('lengthSlider').value);

    // Build combined pool
    var pool = '';
    for (var i = 0; i < selectedSets.length; i++) {
      pool += CHARSETS[selectedSets[i]];
    }

    // Guarantee at least one character from each selected set
    var guaranteed = [];
    for (var s = 0; s < selectedSets.length; s++) {
      var set = CHARSETS[selectedSets[s]];
      guaranteed.push(set.charAt(secureRandomIndex(set.length)));
    }

    // Fill remaining positions from combined pool
    var remaining = length - guaranteed.length;
    var passwordChars = guaranteed.slice();
    for (var r = 0; r < remaining; r++) {
      passwordChars.push(pool.charAt(secureRandomIndex(pool.length)));
    }

    // Shuffle to remove positional bias
    secureShuffle(passwordChars);

    var password = passwordChars.join('');

    document.getElementById('passwordOutput').textContent = password;

    // Calculate entropy
    var charsetSize = pool.length;
    var entropy = Math.log2(Math.pow(charsetSize, length));
    updateStrength(entropy, charsetSize);
  }

  function updateStrength(entropy, charsetSize) {
    var bar1 = document.getElementById('bar1');
    var bar2 = document.getElementById('bar2');
    var bar3 = document.getElementById('bar3');
    var bar4 = document.getElementById('bar4');
    var label = document.getElementById('strengthLabel');
    var entropyLabel = document.getElementById('entropyLabel');
    var inactive = 'var(--color-border)';

    // Reset all bars
    bar1.style.background = inactive;
    bar2.style.background = inactive;
    bar3.style.background = inactive;
    bar4.style.background = inactive;

    if (entropy === 0) {
      label.textContent = '';
      label.style.color = '';
      entropyLabel.textContent = '';
      return;
    }

    var color, text;
    if (entropy < 40) {
      color = '#dc2626';
      text = 'Weak';
      bar1.style.background = color;
    } else if (entropy < 60) {
      color = '#ea580c';
      text = 'Fair';
      bar1.style.background = color;
      bar2.style.background = color;
    } else if (entropy < 80) {
      color = '#16a34a';
      text = 'Strong';
      bar1.style.background = color;
      bar2.style.background = color;
      bar3.style.background = color;
    } else {
      color = '#7c3aed';
      text = 'Very Strong';
      bar1.style.background = color;
      bar2.style.background = color;
      bar3.style.background = color;
      bar4.style.background = color;
    }

    label.textContent = text;
    label.style.color = color;
    entropyLabel.textContent = Math.round(entropy) + ' bits of entropy \u00b7 ' + charsetSize + ' possible characters';
  }

  function copyPassword() {
    var password = document.getElementById('passwordOutput').textContent;
    if (!password || password === 'Generating...' || password === 'Select at least one character type') return;

    if (navigator.clipboard && navigator.clipboard.writeText) {
      navigator.clipboard.writeText(password).then(function() {
        showCopyFeedback(document.getElementById('copyBtn'));
        showCopyFeedback(document.getElementById('copyInlineBtn'));
      });
    } else {
      var textarea = document.createElement('textarea');
      textarea.value = password;
      textarea.style.position = 'fixed';
      textarea.style.opacity = '0';
      document.body.appendChild(textarea);
      textarea.select();
      document.execCommand('copy');
      document.body.removeChild(textarea);
      showCopyFeedback(document.getElementById('copyBtn'));
      showCopyFeedback(document.getElementById('copyInlineBtn'));
    }
  }

  function showCopyFeedback(btn) {
    if (!btn) return;
    var original = btn.textContent;
    btn.textContent = 'Copied!';
    btn.classList.add('copied');
    setTimeout(function() {
      btn.textContent = original;
      btn.classList.remove('copied');
    }, 1500);
  }

  // Update length display
  document.getElementById('lengthSlider').addEventListener('input', function() {
    document.getElementById('lengthValue').textContent = this.value;
    generatePassword();
  });

  // Checkbox listeners
  var checkboxes = ['optUppercase', 'optLowercase', 'optNumbers', 'optSymbols'];
  for (var c = 0; c < checkboxes.length; c++) {
    document.getElementById(checkboxes[c]).addEventListener('change', function() {
      // Prevent unchecking all options
      var selected = getSelectedSets();
      if (selected.length === 0) {
        this.checked = true;
        return;
      }
      generatePassword();
    });
  }

  // Button listeners
  document.getElementById('generateBtn').addEventListener('click', generatePassword);
  document.getElementById('copyBtn').addEventListener('click', copyPassword);
  document.getElementById('copyInlineBtn').addEventListener('click', copyPassword);

  // Generate on load
  generatePassword();
</script>
