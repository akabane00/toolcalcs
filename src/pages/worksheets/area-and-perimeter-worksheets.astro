---
import BaseLayout from '../../layouts/BaseLayout.astro';
import AdUnit from '../../components/AdUnit.astro';
import { getWorksheetBySlug } from '../../data/worksheets';
import '../../styles/worksheet.css';

const ws = getWorksheetBySlug('area-and-perimeter-worksheets')!;

const structuredData = {
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position": 1,
      "name": "Home",
      "item": "https://toolcalcs.com/"
    },
    {
      "@type": "ListItem",
      "position": 2,
      "name": "Worksheets",
      "item": "https://toolcalcs.com/worksheets/"
    },
    {
      "@type": "ListItem",
      "position": 3,
      "name": "Area & Perimeter Worksheets"
    }
  ]
};
---

<BaseLayout
  title="Free Area and Perimeter Worksheets - Printable Math Practice | ToolCalcs"
  description={ws.description}
  type="article"
  structuredData={structuredData}
>
  <nav class="breadcrumb">
    <a href="/">Home</a> &rsaquo;
    <a href="/worksheets/">Worksheets</a> &rsaquo;
    <span>Area &amp; Perimeter Worksheets</span>
  </nav>

  <h1>{ws.title}</h1>
  <p class="page-desc">{ws.description}</p>

  <div class="worksheet-box">
    <div class="config-panel">
      <h3>Settings</h3>
      <div class="config-inputs">
        <div class="config-group">
          <label for="cfgProblems">Number of Problems</label>
          <input type="number" id="cfgProblems" value="10" min="5" max="20" />
        </div>
        <div class="config-group">
          <label for="cfgType">Find</label>
          <select id="cfgType">
            <option value="area">Area Only</option>
            <option value="perimeter">Perimeter Only</option>
            <option value="both" selected>Area and Perimeter</option>
          </select>
        </div>
        <div class="config-group">
          <label for="cfgShapes">Shapes</label>
          <select id="cfgShapes">
            <option value="rectangles" selected>Rectangles &amp; Squares</option>
            <option value="triangles">Triangles</option>
            <option value="mixed">Mixed</option>
          </select>
        </div>
        <div class="config-group">
          <label for="cfgMaxSide">Max Side Length</label>
          <select id="cfgMaxSide">
            <option value="10">Up to 10</option>
            <option value="12" selected>Up to 12</option>
            <option value="20">Up to 20</option>
          </select>
        </div>
      </div>
    </div>

    <div class="worksheet-actions">
      <button class="ws-btn primary" id="btnGenerate">Generate New</button>
      <button class="ws-btn print" id="btnPrint">Print</button>
      <label class="toggle-label">
        <input type="checkbox" id="toggleAnswers" />
        Show Answers
      </label>
    </div>

    <div class="worksheet-content" id="worksheetContent">
      <div class="worksheet-header-print">
        <h2>Area &amp; Perimeter Practice</h2>
        <div class="name-date">
          <span>Name: ___________________</span>
          <span>Date: ___________________</span>
        </div>
      </div>
      <div class="problem-grid ap-grid" id="problemGrid"></div>
      <div class="answer-key hidden" id="answerKey">
        <h3>Answer Key</h3>
        <div class="answer-grid" id="answerGrid"></div>
      </div>
    </div>
  </div>

  <AdUnit slot="ws-mid" format="rectangle" />

  <article class="content-section">
    <h2>Understanding Area and Perimeter</h2>
    <p>Area and perimeter are two fundamental measurements of two-dimensional shapes. <strong>Perimeter</strong> is the total distance around the outside of a shape, measured in linear units such as centimeters, inches, or meters. <strong>Area</strong> is the amount of space inside a shape, measured in square units such as square centimeters (cm&sup2;), square inches (in&sup2;), or square meters (m&sup2;).</p>
    <p>Understanding the difference between area and perimeter is crucial for real-world applications: perimeter tells you how much fencing you need for a yard, while area tells you how much grass seed you need to cover it. These free printable worksheets provide visual shape diagrams with labeled dimensions for students to calculate area, perimeter, or both.</p>

    <h2>Formulas</h2>
    <h3>Rectangles and Squares</h3>
    <ul>
      <li><strong>Area</strong> = length &times; width (A = l &times; w)</li>
      <li><strong>Perimeter</strong> = 2 &times; (length + width) (P = 2l + 2w)</li>
      <li>For squares: Area = side &times; side (A = s&sup2;), Perimeter = 4 &times; side (P = 4s)</li>
    </ul>

    <h3>Triangles</h3>
    <ul>
      <li><strong>Area</strong> = &frac12; &times; base &times; height (A = bh/2)</li>
      <li><strong>Perimeter</strong> = sum of all three sides (P = a + b + c)</li>
    </ul>

    <h2>Grade-Level Guide</h2>
    <h3>Third Grade (Ages 8-9)</h3>
    <p>Third graders are introduced to area and perimeter concepts. They begin with rectangles and squares, calculating perimeter by adding side lengths and area by counting square units or multiplying length by width. Use the "Rectangles &amp; Squares" setting with "Up to 10" side lengths. Start with perimeter only before introducing area.</p>

    <h3>Fourth Grade (Ages 9-10)</h3>
    <p>Fourth graders develop fluency with area and perimeter formulas for rectangles and begin working with triangles. They learn to apply the formulas efficiently and start solving problems that require finding missing dimensions when area or perimeter is given. Use "Mixed" shapes with "Up to 12" for grade-appropriate practice.</p>

    <h3>Fifth Grade (Ages 10-11)</h3>
    <p>Fifth graders work with more complex shapes and larger dimensions. They understand the relationship between area and perimeter and can explain why shapes with the same perimeter can have different areas (and vice versa). Use "Up to 20" side lengths for challenging problems. Students should be comfortable with both rectangle and triangle calculations.</p>

    <h2>Common Mistakes</h2>
    <ul>
      <li><strong>Confusing area and perimeter.</strong> Students often mix up which formula to use. Remind them: perimeter is the distance around (add the sides), area is the space inside (multiply length by width for rectangles).</li>
      <li><strong>Forgetting units.</strong> Perimeter uses linear units (cm, in) while area uses square units (cm&sup2;, in&sup2;). Encourage students to always write the correct unit with their answer.</li>
      <li><strong>Triangle area formula.</strong> Students sometimes forget to divide by 2 when calculating triangle area. Emphasize that a triangle is half of a rectangle with the same base and height.</li>
      <li><strong>Using height vs. side length for triangles.</strong> The height of a triangle is the perpendicular distance from the base to the opposite vertex, which is different from the slant side length. These worksheets clearly label the height with a dashed line.</li>
    </ul>

    <h2>Tips for Teaching Area and Perimeter</h2>
    <ul>
      <li><strong>Use grid paper.</strong> Drawing shapes on grid paper makes counting square units intuitive and helps students understand what "square units" means before introducing formulas.</li>
      <li><strong>Walk the perimeter.</strong> Have students walk around the perimeter of their desk, classroom, or a taped shape on the floor. This physical experience makes the concept of "distance around" concrete.</li>
      <li><strong>Cover the area.</strong> Have students cover a rectangular surface with square tiles to count the area. This connects the formula (l &times; w) to the physical reality of counting unit squares.</li>
      <li><strong>Compare shapes.</strong> Ask students to draw two shapes with the same perimeter but different areas (or vice versa). This deepens understanding of both concepts and their independence.</li>
      <li><strong>Connect to real life.</strong> Use practical scenarios: "How much paint do we need for this wall?" (area), "How much border tape for this bulletin board?" (perimeter).</li>
    </ul>

    <h2>How to Use These Worksheets</h2>
    <p>Select the number of problems, what to find (area, perimeter, or both), shapes, and maximum side length using the settings above. Click "Generate New" for a fresh worksheet. Each problem includes an SVG diagram of the shape with labeled dimensions. Use "Print" for a clean page and "Show Answers" to check work.</p>

    <h2>Related Worksheets</h2>
    <ul>
      <li><a href="/worksheets/multiplication-worksheets/">Multiplication Worksheets</a> - Build multiplication skills needed for area calculations.</li>
      <li><a href="/worksheets/addition-worksheets/">Addition Worksheets</a> - Practice addition for perimeter calculations.</li>
      <li><a href="/worksheets/fractions-worksheets/">Fractions Worksheets</a> - Practice fractions needed for triangle area.</li>
      <li><a href="/worksheets/place-value-worksheets/">Place Value Worksheets</a> - Understand numbers and their values.</li>
    </ul>
  </article>

  <AdUnit slot="ws-bottom" format="horizontal" />
</BaseLayout>

<script is:inline>
  var problems = [];

  function randInt(min, max) {
    return Math.floor(Math.random() * (max - min + 1)) + min;
  }

  function drawRectSVG(w, h, showAnswer, findType) {
    var scale = 8;
    var pad = 40;
    var rightPad = 70;
    var rw = w * scale;
    var rh = h * scale;
    var svgW = rw + pad + rightPad;
    var svgH = rh + pad * 2 + 20;

    var svg = '<svg viewBox="0 0 ' + svgW + ' ' + svgH + '" class="ap-svg">';

    // Rectangle
    svg += '<rect x="' + pad + '" y="' + pad + '" width="' + rw + '" height="' + rh + '" fill="rgba(37,99,235,0.08)" stroke="#334155" stroke-width="2"/>';

    // Width label (top)
    svg += '<text x="' + (pad + rw / 2) + '" y="' + (pad - 8) + '" text-anchor="middle" font-size="13" fill="#334155" font-weight="600">' + w + ' cm</text>';

    // Height label (right)
    svg += '<text x="' + (pad + rw + 14) + '" y="' + (pad + rh / 2) + '" text-anchor="start" font-size="13" fill="#334155" font-weight="600" dominant-baseline="middle">' + h + ' cm</text>';

    // Answer labels
    if (showAnswer) {
      var area = w * h;
      var perimeter = 2 * (w + h);
      var label = '';
      if (findType === 'area') label = 'A = ' + area + ' cm\u00b2';
      else if (findType === 'perimeter') label = 'P = ' + perimeter + ' cm';
      else label = 'A = ' + area + ' cm\u00b2, P = ' + perimeter + ' cm';
      svg += '<text x="' + (pad + rw / 2) + '" y="' + (pad + rh + 20) + '" text-anchor="middle" font-size="11" fill="#2563eb" font-weight="600">' + label + '</text>';
    }

    svg += '</svg>';
    return svg;
  }

  function drawTriSVG(base, height, side1, side2, showAnswer, findType) {
    var scale = 8;
    var pad = 40;
    var rightPad = 60;
    var bw = base * scale;
    var th = height * scale;
    var svgW = bw + pad + rightPad;
    var svgH = th + pad * 2 + 20;

    // Triangle vertices: bottom-left, bottom-right, top-center(ish)
    var x1 = pad, y1 = pad + th;
    var x2 = pad + bw, y2 = pad + th;
    var x3 = pad + bw * 0.4, y3 = pad;

    var svg = '<svg viewBox="0 0 ' + svgW + ' ' + svgH + '" class="ap-svg">';

    // Triangle
    svg += '<polygon points="' + x1 + ',' + y1 + ' ' + x2 + ',' + y2 + ' ' + x3 + ',' + y3 + '" fill="rgba(37,99,235,0.08)" stroke="#334155" stroke-width="2"/>';

    // Base label (bottom)
    svg += '<text x="' + (pad + bw / 2) + '" y="' + (y1 + 18) + '" text-anchor="middle" font-size="13" fill="#334155" font-weight="600">' + base + ' cm</text>';

    // Height dashed line
    svg += '<line x1="' + x3 + '" y1="' + y3 + '" x2="' + x3 + '" y2="' + y1 + '" stroke="#2563eb" stroke-width="1.5" stroke-dasharray="4,3"/>';
    svg += '<text x="' + (x3 - 14) + '" y="' + (pad + th / 2) + '" text-anchor="end" font-size="12" fill="#2563eb" font-weight="600" dominant-baseline="middle">h=' + height + '</text>';

    // Side labels
    var mx1 = (x1 + x3) / 2, my1 = (y1 + y3) / 2;
    svg += '<text x="' + (mx1 - 8) + '" y="' + my1 + '" text-anchor="end" font-size="11" fill="#334155" font-weight="500">' + side1 + '</text>';
    var mx2 = (x2 + x3) / 2, my2 = (y2 + y3) / 2;
    svg += '<text x="' + (mx2 + 8) + '" y="' + my2 + '" text-anchor="start" font-size="11" fill="#334155" font-weight="500">' + side2 + '</text>';

    if (showAnswer) {
      var area = (base * height) / 2;
      var perimeter = base + side1 + side2;
      var label = '';
      if (findType === 'area') label = 'A = ' + area + ' cm\u00b2';
      else if (findType === 'perimeter') label = 'P = ' + perimeter + ' cm';
      else label = 'A = ' + area + ' cm\u00b2, P = ' + perimeter + ' cm';
      svg += '<text x="' + (pad + bw / 2) + '" y="' + (y1 + 34) + '" text-anchor="middle" font-size="11" fill="#2563eb" font-weight="600">' + label + '</text>';
    }

    svg += '</svg>';
    return svg;
  }

  function generateProblems() {
    var count = parseInt(document.getElementById('cfgProblems').value, 10);
    var findType = document.getElementById('cfgType').value;
    var shapes = document.getElementById('cfgShapes').value;
    var maxSide = parseInt(document.getElementById('cfgMaxSide').value, 10);

    if (isNaN(count) || count < 5) count = 5;
    if (count > 20) count = 20;

    problems = [];
    for (var i = 0; i < count; i++) {
      var isRect;
      if (shapes === 'rectangles') isRect = true;
      else if (shapes === 'triangles') isRect = false;
      else isRect = Math.random() < 0.5;

      var thisFind = findType;
      if (findType === 'both') {
        // For "both" mode, alternate or show both
        thisFind = 'both';
      }

      if (isRect) {
        var w = randInt(2, maxSide);
        var h = randInt(2, maxSide);
        var area = w * h;
        var perimeter = 2 * (w + h);
        problems.push({
          shape: 'rectangle',
          w: w, h: h,
          area: area, perimeter: perimeter,
          findType: thisFind
        });
      } else {
        var base = randInt(3, maxSide);
        var height = randInt(2, maxSide);
        // Generate plausible side lengths using Pythagorean theorem approximately
        var halfBase1 = base * 0.4;
        var halfBase2 = base * 0.6;
        var side1 = Math.round(Math.sqrt(halfBase1 * halfBase1 + height * height));
        var side2 = Math.round(Math.sqrt(halfBase2 * halfBase2 + height * height));
        if (side1 < 2) side1 = 2;
        if (side2 < 2) side2 = 2;
        var area = (base * height) / 2;
        var perimeter = base + side1 + side2;
        problems.push({
          shape: 'triangle',
          base: base, height: height,
          side1: side1, side2: side2,
          area: area, perimeter: perimeter,
          findType: thisFind
        });
      }
    }

    renderProblems();
    renderAnswerKey();
    updateAnswerVisibility();
  }

  function renderProblems() {
    var grid = document.getElementById('problemGrid');
    var showAnswers = document.getElementById('toggleAnswers').checked;
    var html = '';

    for (var i = 0; i < problems.length; i++) {
      var p = problems[i];
      html += '<div class="problem ap-problem">';
      html += '<div class="problem-number">' + (i + 1) + ')</div>';

      var label = '';
      if (p.findType === 'area') label = 'Find the <strong>area</strong>.';
      else if (p.findType === 'perimeter') label = 'Find the <strong>perimeter</strong>.';
      else label = 'Find the <strong>area</strong> and <strong>perimeter</strong>.';
      html += '<p class="ap-question">' + label + '</p>';

      if (p.shape === 'rectangle') {
        html += drawRectSVG(p.w, p.h, showAnswers, p.findType);
      } else {
        html += drawTriSVG(p.base, p.height, p.side1, p.side2, showAnswers, p.findType);
      }

      if (!showAnswers) {
        if (p.findType === 'area' || p.findType === 'both') {
          html += '<div class="ap-answer-line">Area = ___________</div>';
        }
        if (p.findType === 'perimeter' || p.findType === 'both') {
          html += '<div class="ap-answer-line">Perimeter = ___________</div>';
        }
      }

      html += '</div>';
    }

    grid.innerHTML = html;
  }

  function renderAnswerKey() {
    var answerGrid = document.getElementById('answerGrid');
    var html = '';
    for (var i = 0; i < problems.length; i++) {
      var p = problems[i];
      var ans = '';
      if (p.findType === 'area') ans = 'A = ' + p.area + ' cm\u00b2';
      else if (p.findType === 'perimeter') ans = 'P = ' + p.perimeter + ' cm';
      else ans = 'A = ' + p.area + ' cm\u00b2, P = ' + p.perimeter + ' cm';
      html += '<div class="answer-item">';
      html += '<span class="q">' + (i + 1) + '.</span>';
      html += '<span class="a">' + ans + '</span>';
      html += '</div>';
    }
    answerGrid.innerHTML = html;
  }

  function updateAnswerVisibility() {
    var showAnswers = document.getElementById('toggleAnswers').checked;
    var answerKey = document.getElementById('answerKey');
    if (showAnswers) { answerKey.classList.remove('hidden'); }
    else { answerKey.classList.add('hidden'); }
    renderProblems();
  }

  document.getElementById('btnGenerate').addEventListener('click', generateProblems);
  document.getElementById('btnPrint').addEventListener('click', function () { window.print(); });
  document.getElementById('toggleAnswers').addEventListener('change', updateAnswerVisibility);
  generateProblems();
</script>

<style>
  :global(.ap-grid) {
    grid-template-columns: repeat(auto-fill, minmax(240px, 1fr)) !important;
  }
  :global(.ap-problem) {
    flex-direction: column !important;
    align-items: center !important;
    min-height: 180px;
    padding: 14px !important;
  }
  :global(.ap-question) {
    font-size: 0.95rem;
    margin-bottom: 6px;
    text-align: center;
  }
  :global(.ap-svg) {
    width: 100%;
    max-width: 300px;
    height: auto;
    display: block;
    margin: 0 auto;
  }
  :global(.ap-answer-line) {
    font-size: 0.9rem;
    color: var(--color-text-muted);
    margin-top: 4px;
  }
  @media (max-width: 640px) {
    :global(.ap-grid) { grid-template-columns: 1fr !important; }
  }
  @media print {
    :global(.ap-svg text[fill="#2563eb"]) { fill: #333 !important; }
    :global(.ap-svg [fill="rgba(37,99,235,0.08)"]) { fill: #f0f0f0 !important; }
    :global(.ap-svg [stroke="#2563eb"]) { stroke: #555 !important; }
  }
</style>
