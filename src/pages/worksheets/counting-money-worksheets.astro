---
import BaseLayout from '../../layouts/BaseLayout.astro';
import AdUnit from '../../components/AdUnit.astro';
import { getWorksheetBySlug } from '../../data/worksheets';
import '../../styles/worksheet.css';

const ws = getWorksheetBySlug('counting-money-worksheets')!;

const structuredData = {
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    { "@type": "ListItem", "position": 1, "name": "Home", "item": "https://toolcalcs.com/" },
    { "@type": "ListItem", "position": 2, "name": "Worksheets", "item": "https://toolcalcs.com/worksheets/" },
    { "@type": "ListItem", "position": 3, "name": ws.title }
  ]
};
---

<BaseLayout
  title="Free Counting Money Worksheets - Coins & Bills Practice | ToolCalcs"
  description={ws.description}
  structuredData={structuredData}
>
  <nav class="breadcrumb">
    <a href="/">Home</a> &rsaquo; <a href="/worksheets/">Worksheets</a> &rsaquo; <span>{ws.title}</span>
  </nav>

  <h1>{ws.title}</h1>
  <p class="page-desc">{ws.description}</p>

  <div class="worksheet-box">
    <!-- Config Panel -->
    <div class="config-panel">
      <h3>Worksheet Settings</h3>
      <div class="config-inputs">
        <div class="config-group">
          <label for="cfg-problems">Number of Problems</label>
          <input type="number" id="cfg-problems" min="4" max="20" value="10" />
        </div>
        <div class="config-group">
          <label for="cfg-coinTypes">Coin Types</label>
          <select id="cfg-coinTypes">
            <option value="coins" selected>Coins Only</option>
            <option value="bills">Bills Only</option>
            <option value="both">Coins and Bills</option>
          </select>
        </div>
        <div class="config-group">
          <label for="cfg-maxTotal">Max Total</label>
          <select id="cfg-maxTotal">
            <option value="0.50">Up to 50&cent;</option>
            <option value="1.00" selected>Up to $1.00</option>
            <option value="5.00">Up to $5.00</option>
            <option value="20.00">Up to $20.00</option>
          </select>
        </div>
      </div>
    </div>

    <!-- Worksheet Actions -->
    <div class="worksheet-actions">
      <button class="ws-btn primary" id="btn-generate">Generate New</button>
      <button class="ws-btn print" id="btn-print" onclick="window.print()">Print</button>
      <label class="toggle-label">
        <input type="checkbox" id="toggle-answers" /> Show Answers
      </label>
    </div>

    <!-- Worksheet Content -->
    <div class="worksheet-content" id="worksheet-area">
      <div class="worksheet-header-print">
        <h2>Counting Money</h2>
        <div class="name-date">
          <span>Name: ___________________</span>
          <span>Date: ___________________</span>
        </div>
      </div>
      <div class="problem-grid" id="problem-grid"></div>
      <div class="answer-key hidden" id="answer-key">
        <h3>Answer Key</h3>
        <div class="answer-grid" id="answer-grid"></div>
      </div>
    </div>
  </div>

  <AdUnit slot="ws-mid" format="horizontal" />

  <article class="content-section">
    <h2>Why Counting Money Worksheets Matter</h2>
    <p>Learning to count money is one of the most practical math skills a child can develop. Unlike abstract arithmetic, counting coins and bills connects directly to everyday life, from buying a snack at the school cafeteria to saving up for a favorite toy. These free printable counting money worksheets give students hands-on practice identifying US coins and bills, adding their values, and building the kind of number sense that supports long-term mathematical confidence.</p>
    <p>Counting money exercises reinforce addition, place value, and decimal concepts all at once. When a child adds a quarter, two dimes, and three pennies, they practice skip counting by 25s, 10s, and 1s while working toward a total. This multi-layered thinking strengthens mental math abilities and helps students see connections between different math topics they are studying in school.</p>

    <h2>Recognizing US Coins and Bills</h2>
    <p>Before students can count money accurately, they need to recognize each coin and bill and recall its value instantly. The four primary US coins each have distinct sizes, colors, and designs that help with identification:</p>
    <ul>
      <li><strong>Penny (1 cent):</strong> The copper-colored coin featuring Abraham Lincoln. It is the smallest unit of US currency and the building block for understanding cents.</li>
      <li><strong>Nickel (5 cents):</strong> Larger than a penny with a silver appearance, showing Thomas Jefferson. Worth five pennies, it introduces the concept of equivalent values.</li>
      <li><strong>Dime (10 cents):</strong> The smallest coin by diameter, featuring Franklin D. Roosevelt. Despite its small size, it is worth more than a nickel, which is an important lesson about value versus physical size.</li>
      <li><strong>Quarter (25 cents):</strong> The largest common coin, showing George Washington. Quarters are essential for practical transactions and provide excellent skip-counting practice by 25s.</li>
    </ul>
    <p>When students are ready, US bills extend the challenge. Dollar bills come in denominations of $1, $5, $10, and $20 for everyday use. Working with bills helps children understand larger amounts and practice combining dollars and cents into a single total, such as $3.47 or $12.85.</p>

    <h2>How to Use These Worksheets</h2>
    <p>Each worksheet presents a set of problems showing groups of coins, bills, or both. The student counts the total value of each group and writes the answer in dollar-and-cent format. Use the settings panel above to customize the difficulty level for your child or classroom:</p>
    <ul>
      <li><strong>Coins Only:</strong> Start here for beginners. Problems use only pennies, nickels, dimes, and quarters with totals up to 50 cents or one dollar.</li>
      <li><strong>Bills Only:</strong> Practice with paper currency for students who have mastered coins and need to work with larger amounts.</li>
      <li><strong>Coins and Bills:</strong> The most challenging setting combines both, requiring students to add dollars and cents together for totals up to $20.00.</li>
    </ul>
    <p>For best results, start with a lower maximum total and fewer problems, then gradually increase difficulty as the student gains confidence. The "Generate New" button creates a fresh set of problems each time, so you never run out of practice material.</p>

    <h3>Tips for Parents and Teachers</h3>
    <p>Pair these worksheets with real coins and bills whenever possible. Physical money gives students a tactile experience that reinforces the visual learning from the worksheet. Have them sort coins by type, then count each group before finding the grand total. This approach builds organizational skills alongside arithmetic. Encourage students to start with the highest-value coins or bills first and count down, which is more efficient than starting with pennies and counting up one cent at a time.</p>

    <h2>Building Financial Literacy Early</h2>
    <p>Counting money worksheets do more than teach arithmetic. They lay the groundwork for financial literacy, a skill set that will serve students throughout their lives. Children who are comfortable handling money develop a natural sense of value, budgeting, and comparison shopping. They begin to understand that four quarters equal one dollar, that some combinations of coins are more efficient than others, and that careful counting prevents errors in real transactions.</p>
    <p>Research consistently shows that early exposure to money concepts correlates with better financial decision-making in adulthood. By giving young learners regular practice with coins and bills, you help them build the confidence and competence they need to manage money responsibly as they grow. Print a new worksheet each day or week to keep skills sharp and watch your students progress from counting pennies to handling multi-dollar amounts with ease.</p>
  </article>

  <AdUnit slot="ws-bottom" format="horizontal" />
</BaseLayout>

<script>
  type CoinType = 'penny' | 'nickel' | 'dime' | 'quarter';
  type BillType = '$1' | '$5' | '$10' | '$20';

  interface MoneyPiece {
    type: 'coin' | 'bill';
    name: CoinType | BillType;
    value: number;
    label: string;
    cssClass: string;
  }

  const COINS: MoneyPiece[] = [
    { type: 'coin', name: 'quarter', value: 25, label: '25\u00A2', cssClass: 'coin quarter' },
    { type: 'coin', name: 'dime',    value: 10, label: '10\u00A2', cssClass: 'coin dime' },
    { type: 'coin', name: 'nickel',  value: 5,  label: '5\u00A2',  cssClass: 'coin nickel' },
    { type: 'coin', name: 'penny',   value: 1,  label: '1\u00A2',  cssClass: 'coin penny' },
  ];

  const BILLS: MoneyPiece[] = [
    { type: 'bill', name: '$20', value: 2000, label: '$20', cssClass: 'bill' },
    { type: 'bill', name: '$10', value: 1000, label: '$10', cssClass: 'bill' },
    { type: 'bill', name: '$5',  value: 500,  label: '$5',  cssClass: 'bill' },
    { type: 'bill', name: '$1',  value: 100,  label: '$1',  cssClass: 'bill' },
  ];

  interface Problem {
    pieces: MoneyPiece[];
    totalCents: number;
    answer: string;
  }

  function randInt(min: number, max: number): number {
    return Math.floor(Math.random() * (max - min + 1)) + min;
  }

  function formatMoney(cents: number): string {
    const dollars = Math.floor(cents / 100);
    const remainder = cents % 100;
    return `$${dollars}.${String(remainder).padStart(2, '0')}`;
  }

  function breakIntoCoins(cents: number): MoneyPiece[] {
    const pieces: MoneyPiece[] = [];
    let remaining = cents;
    for (const coin of COINS) {
      while (remaining >= coin.value) {
        pieces.push(coin);
        remaining -= coin.value;
      }
    }
    return pieces;
  }

  function breakIntoBills(cents: number): MoneyPiece[] {
    const pieces: MoneyPiece[] = [];
    let remaining = cents;
    for (const bill of BILLS) {
      while (remaining >= bill.value) {
        pieces.push(bill);
        remaining -= bill.value;
      }
    }
    return pieces;
  }

  function breakIntoBoth(cents: number): MoneyPiece[] {
    const pieces: MoneyPiece[] = [];
    let remaining = cents;

    // Break into bills first
    for (const bill of BILLS) {
      while (remaining >= bill.value) {
        pieces.push(bill);
        remaining -= bill.value;
      }
    }

    // Then break remaining into coins
    for (const coin of COINS) {
      while (remaining >= coin.value) {
        pieces.push(coin);
        remaining -= coin.value;
      }
    }

    return pieces;
  }

  function generateRandomTotal(maxCents: number, coinTypes: string): number {
    let minCents: number;

    if (coinTypes === 'bills') {
      // Bills only: minimum $1, round to whole dollars
      minCents = 100;
      const maxDollars = Math.floor(maxCents / 100);
      const minDollars = 1;
      const dollars = randInt(minDollars, maxDollars);
      return dollars * 100;
    } else if (coinTypes === 'coins') {
      // Coins only: 1 cent to maxCents (capped at 99 if max is $1+)
      const effectiveMax = Math.min(maxCents, 99);
      minCents = 5;
      return randInt(minCents, effectiveMax);
    } else {
      // Both: minimum $1.01 to ensure we get both bills and coins
      minCents = 101;
      if (maxCents < minCents) {
        // If max is too low for both, fall back to coins
        return randInt(5, maxCents);
      }
      // Generate a total that is not a round dollar amount so coins appear
      let total = randInt(minCents, maxCents);
      if (total % 100 === 0) {
        total += randInt(1, 99);
        if (total > maxCents) total = maxCents - randInt(1, 50);
        if (total < minCents) total = minCents;
      }
      return total;
    }
  }

  function generateProblem(maxCents: number, coinTypes: string): Problem {
    const totalCents = generateRandomTotal(maxCents, coinTypes);
    let pieces: MoneyPiece[];

    if (coinTypes === 'coins') {
      pieces = breakIntoCoins(totalCents);
    } else if (coinTypes === 'bills') {
      pieces = breakIntoBills(totalCents);
    } else {
      pieces = breakIntoBoth(totalCents);
    }

    // Shuffle pieces for visual variety (keep bills before coins, but shuffle within each group)
    const billPieces = pieces.filter(p => p.type === 'bill');
    const coinPieces = pieces.filter(p => p.type === 'coin');
    shuffle(billPieces);
    shuffle(coinPieces);
    pieces = [...billPieces, ...coinPieces];

    return {
      pieces,
      totalCents,
      answer: formatMoney(totalCents),
    };
  }

  function shuffle<T>(arr: T[]): void {
    for (let i = arr.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [arr[i], arr[j]] = [arr[j], arr[i]];
    }
  }

  function renderProblems(problems: Problem[]): void {
    const grid = document.getElementById('problem-grid')!;
    const answerGrid = document.getElementById('answer-grid')!;

    grid.innerHTML = '';
    answerGrid.innerHTML = '';

    problems.forEach((problem, index) => {
      // Build problem HTML
      const div = document.createElement('div');
      div.className = 'problem money-problem';

      const numDiv = document.createElement('div');
      numDiv.className = 'problem-number';
      numDiv.textContent = `${index + 1})`;
      div.appendChild(numDiv);

      const rowDiv = document.createElement('div');
      rowDiv.className = 'coin-row';

      problem.pieces.forEach(piece => {
        const span = document.createElement('span');
        span.className = piece.cssClass;
        span.textContent = piece.label;
        rowDiv.appendChild(span);
      });

      div.appendChild(rowDiv);

      const answerDiv = document.createElement('div');
      answerDiv.className = 'problem-answer';
      answerDiv.dataset.answer = problem.answer;
      answerDiv.textContent = '$___';
      div.appendChild(answerDiv);

      grid.appendChild(div);

      // Build answer key entry
      const answerItem = document.createElement('div');
      answerItem.className = 'answer-item';
      answerItem.innerHTML = `<span class="q">${index + 1})</span> <span class="a">${problem.answer}</span>`;
      answerGrid.appendChild(answerItem);
    });
  }

  function generateWorksheet(): void {
    const numProblems = Math.max(4, Math.min(20,
      parseInt((document.getElementById('cfg-problems') as HTMLInputElement).value, 10) || 10
    ));
    const coinTypes = (document.getElementById('cfg-coinTypes') as HTMLSelectElement).value;
    const maxTotal = parseFloat((document.getElementById('cfg-maxTotal') as HTMLSelectElement).value);
    const maxCents = Math.round(maxTotal * 100);

    const problems: Problem[] = [];
    const usedTotals = new Set<number>();

    for (let i = 0; i < numProblems; i++) {
      let attempts = 0;
      let problem: Problem;
      do {
        problem = generateProblem(maxCents, coinTypes);
        attempts++;
      } while (usedTotals.has(problem.totalCents) && attempts < 50);

      usedTotals.add(problem.totalCents);
      problems.push(problem);
    }

    renderProblems(problems);
    updateAnswerVisibility();
  }

  function updateAnswerVisibility(): void {
    const showAnswers = (document.getElementById('toggle-answers') as HTMLInputElement).checked;
    const answerKey = document.getElementById('answer-key')!;
    const problemAnswers = document.querySelectorAll('.problem-answer');

    if (showAnswers) {
      answerKey.classList.remove('hidden');
      problemAnswers.forEach(el => {
        const answer = (el as HTMLElement).dataset.answer || '';
        el.textContent = answer;
        el.classList.add('revealed');
      });
    } else {
      answerKey.classList.add('hidden');
      problemAnswers.forEach(el => {
        el.textContent = '$___';
        el.classList.remove('revealed');
      });
    }
  }

  // Event listeners
  document.getElementById('btn-generate')!.addEventListener('click', generateWorksheet);
  document.getElementById('toggle-answers')!.addEventListener('change', updateAnswerVisibility);

  // Adjust grid columns for money problems (they need more horizontal space)
  const style = document.createElement('style');
  style.textContent = `
    .problem-grid { grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); }
    @media (max-width: 640px) { .problem-grid { grid-template-columns: 1fr; } }
  `;
  document.head.appendChild(style);

  // Generate initial worksheet on load
  generateWorksheet();
</script>
