---
import BaseLayout from '../../layouts/BaseLayout.astro';
import AdUnit from '../../components/AdUnit.astro';
import { getWorksheetBySlug } from '../../data/worksheets';
import '../../styles/worksheet.css';

const ws = getWorksheetBySlug('fact-families-worksheets')!;

const structuredData = {
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position": 1,
      "name": "Home",
      "item": "https://toolcalcs.com/"
    },
    {
      "@type": "ListItem",
      "position": 2,
      "name": "Worksheets",
      "item": "https://toolcalcs.com/worksheets/"
    },
    {
      "@type": "ListItem",
      "position": 3,
      "name": "Fact Families Worksheets"
    }
  ]
};
---

<BaseLayout
  title="Free Fact Family Worksheets - Printable Math Practice | ToolCalcs"
  description={ws.description}
  type="article"
  structuredData={structuredData}
>
  <nav class="breadcrumb">
    <a href="/">Home</a> &rsaquo;
    <a href="/worksheets/">Worksheets</a> &rsaquo;
    <span>Fact Families Worksheets</span>
  </nav>

  <h1>{ws.title}</h1>
  <p class="page-desc">{ws.description}</p>

  <div class="worksheet-box">
    <div class="config-panel">
      <h3>Settings</h3>
      <div class="config-inputs">
        <div class="config-group">
          <label for="cfgProblems">Number of Problems</label>
          <input type="number" id="cfgProblems" value="10" min="5" max="20" />
        </div>
        <div class="config-group">
          <label for="cfgOperation">Operation</label>
          <select id="cfgOperation">
            <option value="addSub" selected>Addition &amp; Subtraction</option>
            <option value="mulDiv">Multiplication &amp; Division</option>
          </select>
        </div>
        <div class="config-group">
          <label for="cfgMax">Max Number</label>
          <select id="cfgMax">
            <option value="10" selected>Up to 10</option>
            <option value="12">Up to 12</option>
            <option value="20">Up to 20</option>
          </select>
        </div>
      </div>
    </div>

    <div class="worksheet-actions">
      <button class="ws-btn primary" id="btnGenerate">Generate New</button>
      <button class="ws-btn print" id="btnPrint">Print</button>
      <label class="toggle-label">
        <input type="checkbox" id="toggleAnswers" />
        Show Answers
      </label>
    </div>

    <div class="worksheet-content" id="worksheetContent">
      <div class="worksheet-header-print">
        <h2>Fact Families Practice</h2>
        <div class="name-date">
          <span>Name: ___________________</span>
          <span>Date: ___________________</span>
        </div>
        <p class="ws-instructions">Write the four related facts for each fact family.</p>
      </div>
      <div class="problem-grid ff-grid" id="problemGrid"></div>
      <div class="answer-key hidden" id="answerKey">
        <h3>Answer Key</h3>
        <div class="answer-grid ff-answer-grid" id="answerGrid"></div>
      </div>
    </div>
  </div>

  <AdUnit slot="ws-mid" format="rectangle" />

  <article class="content-section">
    <h2>What Are Fact Families?</h2>
    <p>A fact family is a group of related math facts that use the same three numbers. For addition and subtraction, the family shows how these two operations are inverses of each other. For example, the numbers 3, 5, and 8 form a fact family: 3 + 5 = 8, 5 + 3 = 8, 8 - 3 = 5, and 8 - 5 = 3. Similarly, for multiplication and division, the numbers 4, 6, and 24 produce: 4 &times; 6 = 24, 6 &times; 4 = 24, 24 &divide; 4 = 6, and 24 &divide; 6 = 4.</p>
    <p>Understanding fact families helps students see the deep connection between operations. Instead of memorizing isolated facts, students learn that knowing one fact automatically gives them three related facts. This builds number sense and makes learning basic facts much more efficient.</p>

    <h2>Why Fact Families Matter</h2>
    <p>Fact families are not just a classroom exercise. They build the foundation for algebraic thinking. When a student understands that 3 + 5 = 8 means 8 - 5 = 3, they are working with the same logical structure as solving x + 5 = 8 for x. This inverse relationship between operations is one of the most important concepts in all of mathematics.</p>
    <p>Fact families also improve fact fluency dramatically. A student who learns the multiplication fact 7 &times; 8 = 56 automatically knows 8 &times; 7 = 56, 56 &divide; 7 = 8, and 56 &divide; 8 = 7. This quadruples the value of learning each individual fact.</p>

    <h2>The Fact Family Triangle</h2>
    <p>Each problem on this worksheet shows a triangle (sometimes called a "fact house") with three numbers. The largest number sits at the top, and the two smaller numbers sit at the bottom corners. Students use these three numbers to write all four related equations. The triangle visual makes it clear which number is the sum (or product) and which are the parts (or factors).</p>

    <h2>Grade-Level Guide</h2>
    <h3>Kindergarten (Ages 5-6)</h3>
    <p>Kindergartners begin exploring the relationship between addition and subtraction using small numbers. Use the "Addition &amp; Subtraction" type with "Up to 10" to keep numbers manageable. At this age, manipulatives and visual models support the worksheet practice.</p>

    <h3>First Grade (Ages 6-7)</h3>
    <p>First graders work extensively with addition and subtraction fact families for sums up to 20. They should be able to write all four facts given three numbers. Use "Up to 12" or "Up to 20" for appropriate challenge. By the end of first grade, students should understand that subtraction "undoes" addition.</p>

    <h3>Second Grade (Ages 7-8)</h3>
    <p>Second graders extend fact families to multiplication and division as they learn their times tables. Use the "Multiplication &amp; Division" type with "Up to 10" or "Up to 12" to align with the multiplication facts they are learning. Understanding that division is the inverse of multiplication makes learning division facts much faster.</p>

    <h2>Tips for Teaching Fact Families</h2>
    <ul>
      <li><strong>Start with concrete objects.</strong> Use counters, blocks, or snack items to show how a group can be put together (addition) and taken apart (subtraction). Physically moving objects makes the inverse relationship visible.</li>
      <li><strong>Use the triangle model.</strong> The fact family triangle gives students a visual anchor. Practice placing the numbers correctly: the total always goes on top.</li>
      <li><strong>Connect addition to subtraction explicitly.</strong> After students write 3 + 5 = 8, ask: "If we know 3 + 5 = 8, what do we know about 8 - 5?" Help them see it's the same relationship.</li>
      <li><strong>Practice writing all four facts.</strong> Even when students can solve the facts mentally, writing all four builds the habit of seeing connections between operations.</li>
      <li><strong>Look for doubles.</strong> When both parts are equal (like 4 + 4 = 8), the family only has two unique equations instead of four. This is a great discussion opportunity about why.</li>
      <li><strong>Move to multiplication/division.</strong> Once students are comfortable with add/sub families, transition to mul/div families. The same triangle model works perfectly.</li>
    </ul>

    <h2>How to Use These Worksheets</h2>
    <p>Select the number of problems, operation type, and maximum number using the settings above. Click "Generate New" for a fresh worksheet. Each problem shows a fact family triangle with three numbers. Students write the four related equations below. Use "Print" for a clean page and "Show Answers" to check work or reveal the answer key.</p>

    <h2>Related Worksheets</h2>
    <ul>
      <li><a href="/worksheets/addition-worksheets/">Addition Worksheets</a> - Practice addition facts and multi-digit addition.</li>
      <li><a href="/worksheets/subtraction-worksheets/">Subtraction Worksheets</a> - Practice subtraction facts and multi-digit subtraction.</li>
      <li><a href="/worksheets/multiplication-worksheets/">Multiplication Worksheets</a> - Times tables and multi-digit multiplication.</li>
      <li><a href="/worksheets/division-worksheets/">Division Worksheets</a> - Basic division facts practice.</li>
    </ul>
  </article>

  <AdUnit slot="ws-bottom" format="horizontal" />
</BaseLayout>

<script is:inline>
  var problems = [];

  function randInt(min, max) {
    return Math.floor(Math.random() * (max - min + 1)) + min;
  }

  function generateProblems() {
    var count = parseInt(document.getElementById('cfgProblems').value, 10);
    var operation = document.getElementById('cfgOperation').value;
    var maxNum = parseInt(document.getElementById('cfgMax').value, 10);

    if (isNaN(count) || count < 5) count = 5;
    if (count > 20) count = 20;

    problems = [];
    var used = {};

    for (var i = 0; i < count; i++) {
      var a, b, c, facts;
      var attempts = 0;

      do {
        if (operation === 'addSub') {
          a = randInt(1, Math.floor(maxNum / 2));
          b = randInt(1, maxNum - a);
          c = a + b;
          var key = Math.min(a, b) + ',' + Math.max(a, b);
        } else {
          a = randInt(2, Math.min(maxNum, 12));
          b = randInt(2, Math.min(maxNum, 12));
          c = a * b;
          var key = Math.min(a, b) + 'x' + Math.max(a, b);
        }
        attempts++;
      } while (used[key] && attempts < 100);
      used[key] = true;

      if (operation === 'addSub') {
        facts = [
          a + ' + ' + b + ' = ' + c,
          b + ' + ' + a + ' = ' + c,
          c + ' \u2212 ' + a + ' = ' + b,
          c + ' \u2212 ' + b + ' = ' + a
        ];
      } else {
        facts = [
          a + ' \u00d7 ' + b + ' = ' + c,
          b + ' \u00d7 ' + a + ' = ' + c,
          c + ' \u00f7 ' + a + ' = ' + b,
          c + ' \u00f7 ' + b + ' = ' + a
        ];
      }

      // If a === b, only 2 unique facts
      if (a === b) {
        facts = [facts[0], facts[2]];
      }

      problems.push({ a: a, b: b, c: c, facts: facts });
    }

    renderProblems();
    renderAnswerKey();
    updateAnswerVisibility();
  }

  function drawTriangle(a, b, c) {
    var svg = '<svg viewBox="0 0 110 105" class="ff-triangle">';
    // Triangle shape
    svg += '<polygon points="55,8 10,90 100,90" fill="none" stroke="#334155" stroke-width="2.5" stroke-linejoin="round"/>';
    // Numbers
    svg += '<text x="55" y="45" text-anchor="middle" font-size="18" font-weight="700" fill="#2563eb">' + c + '</text>';
    svg += '<text x="28" y="82" text-anchor="middle" font-size="16" font-weight="600" fill="#334155">' + a + '</text>';
    svg += '<text x="82" y="82" text-anchor="middle" font-size="16" font-weight="600" fill="#334155">' + b + '</text>';
    svg += '</svg>';
    return svg;
  }

  function renderProblems() {
    var grid = document.getElementById('problemGrid');
    var showAnswers = document.getElementById('toggleAnswers').checked;
    var operation = document.getElementById('cfgOperation').value;
    var html = '';

    for (var i = 0; i < problems.length; i++) {
      var p = problems[i];
      var opSymbols = operation === 'addSub' ? ['+', '\u2212'] : ['\u00d7', '\u00f7'];

      html += '<div class="problem ff-problem">';
      html += '<div class="problem-number">' + (i + 1) + ')</div>';
      html += drawTriangle(p.a, p.b, p.c);

      html += '<div class="ff-equations">';
      if (p.a === p.b) {
        // Only 2 unique equations for doubles
        html += '<div class="ff-eq">';
        if (showAnswers) {
          html += '<span class="ff-fact revealed">' + p.facts[0] + '</span>';
        } else {
          html += '<span class="ff-blank"></span> ' + opSymbols[0] + ' <span class="ff-blank"></span> = <span class="ff-blank"></span>';
        }
        html += '</div>';
        html += '<div class="ff-eq">';
        if (showAnswers) {
          html += '<span class="ff-fact revealed">' + p.facts[1] + '</span>';
        } else {
          html += '<span class="ff-blank"></span> ' + opSymbols[1] + ' <span class="ff-blank"></span> = <span class="ff-blank"></span>';
        }
        html += '</div>';
      } else {
        for (var j = 0; j < 4; j++) {
          html += '<div class="ff-eq">';
          if (showAnswers) {
            html += '<span class="ff-fact revealed">' + p.facts[j] + '</span>';
          } else {
            var sym = j < 2 ? opSymbols[0] : opSymbols[1];
            html += '<span class="ff-blank"></span> ' + sym + ' <span class="ff-blank"></span> = <span class="ff-blank"></span>';
          }
          html += '</div>';
        }
      }
      html += '</div>';

      html += '</div>';
    }

    grid.innerHTML = html;
  }

  function renderAnswerKey() {
    var answerGrid = document.getElementById('answerGrid');
    var html = '';
    for (var i = 0; i < problems.length; i++) {
      var p = problems[i];
      html += '<div class="answer-item">';
      html += '<span class="q">' + (i + 1) + '.</span>';
      html += '<span class="a">' + p.facts.join(' &nbsp;|&nbsp; ') + '</span>';
      html += '</div>';
    }
    answerGrid.innerHTML = html;
  }

  function updateAnswerVisibility() {
    var showAnswers = document.getElementById('toggleAnswers').checked;
    var answerKey = document.getElementById('answerKey');
    if (showAnswers) { answerKey.classList.remove('hidden'); }
    else { answerKey.classList.add('hidden'); }
    renderProblems();
  }

  document.getElementById('btnGenerate').addEventListener('click', generateProblems);
  document.getElementById('btnPrint').addEventListener('click', function () { window.print(); });
  document.getElementById('toggleAnswers').addEventListener('change', updateAnswerVisibility);
  generateProblems();
</script>

<style>
  :global(.ff-grid) {
    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)) !important;
  }
  :global(.ff-problem) {
    flex-direction: column !important;
    align-items: center !important;
    min-height: 200px;
    padding: 14px !important;
  }
  :global(.ff-triangle) {
    width: 90px;
    height: 86px;
    display: block;
    margin: 0 auto 10px;
  }
  :global(.ff-equations) {
    font-size: 0.9rem;
    line-height: 2;
    text-align: left;
    width: 100%;
  }
  :global(.ff-eq) {
    display: flex;
    align-items: center;
    gap: 4px;
    font-family: 'Courier New', Courier, monospace;
    font-weight: 600;
  }
  :global(.ff-blank) {
    display: inline-block;
    width: 28px;
    height: 22px;
    border-bottom: 2px solid var(--color-border);
    text-align: center;
  }
  :global(.ff-fact) {
    font-family: 'Courier New', Courier, monospace;
  }
  :global(.ff-fact.revealed) {
    color: var(--color-primary);
    font-weight: 700;
  }
  :global(.ff-answer-grid) {
    grid-template-columns: 1fr !important;
  }
  :global(.ws-instructions) {
    font-size: 0.9rem;
    color: var(--color-text-muted);
    margin-top: 6px;
  }
  @media (max-width: 640px) {
    :global(.ff-grid) { grid-template-columns: repeat(2, 1fr) !important; }
  }
  @media print {
    :global(.ff-triangle text[fill="#2563eb"]) { fill: #333 !important; }
    :global(.ff-fact.revealed) { color: inherit; }
  }
</style>
