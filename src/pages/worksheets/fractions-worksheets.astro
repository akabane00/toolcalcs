---
import BaseLayout from '../../layouts/BaseLayout.astro';
import AdUnit from '../../components/AdUnit.astro';
import { getWorksheetBySlug } from '../../data/worksheets';
import '../../styles/worksheet.css';

const ws = getWorksheetBySlug('fractions-worksheets')!;

const structuredData = {
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position": 1,
      "name": "Home",
      "item": "https://toolcalcs.com/"
    },
    {
      "@type": "ListItem",
      "position": 2,
      "name": "Worksheets",
      "item": "https://toolcalcs.com/worksheets/"
    },
    {
      "@type": "ListItem",
      "position": 3,
      "name": "Fractions Worksheets"
    }
  ]
};
---

<BaseLayout
  title="Free Fractions Worksheets - Printable Math Practice | ToolCalcs"
  description={ws.description}
  type="article"
  structuredData={structuredData}
>
  <nav class="breadcrumb">
    <a href="/">Home</a> &rsaquo;
    <a href="/worksheets/">Worksheets</a> &rsaquo;
    <span>Fractions Worksheets</span>
  </nav>

  <h1>{ws.title}</h1>
  <p class="page-desc">{ws.description}</p>

  <div class="worksheet-box">
    <div class="config-panel">
      <h3>Settings</h3>
      <div class="config-inputs">
        <div class="config-group">
          <label for="cfgProblems">Number of Problems</label>
          <input type="number" id="cfgProblems" value="16" min="5" max="30" />
        </div>
        <div class="config-group">
          <label for="cfgType">Problem Type</label>
          <select id="cfgType">
            <option value="identify">Identify Fractions (Visual)</option>
            <option value="equivalent">Equivalent Fractions</option>
            <option value="compare">Compare Fractions</option>
            <option value="addSame">Add (Same Denominator)</option>
            <option value="subSame">Subtract (Same Denominator)</option>
            <option value="addDiff">Add (Different Denom.)</option>
            <option value="subDiff">Subtract (Different Denom.)</option>
          </select>
        </div>
        <div class="config-group">
          <label for="cfgMaxDenom">Max Denominator</label>
          <select id="cfgMaxDenom">
            <option value="4">Up to 4</option>
            <option value="8" selected>Up to 8</option>
            <option value="12">Up to 12</option>
          </select>
        </div>
      </div>
    </div>

    <div class="worksheet-actions">
      <button class="ws-btn primary" id="btnGenerate">Generate New</button>
      <button class="ws-btn print" id="btnPrint">Print</button>
      <label class="toggle-label">
        <input type="checkbox" id="toggleAnswers" />
        Show Answers
      </label>
    </div>

    <div class="worksheet-content" id="worksheetContent">
      <div class="worksheet-header-print">
        <h2>Fractions Practice</h2>
        <div class="name-date">
          <span>Name: ___________________</span>
          <span>Date: ___________________</span>
        </div>
      </div>
      <div class="problem-grid" id="problemGrid"></div>
      <div class="answer-key hidden" id="answerKey">
        <h3>Answer Key</h3>
        <div class="answer-grid" id="answerGrid"></div>
      </div>
    </div>
  </div>

  <AdUnit slot="ws-mid" format="rectangle" />

  <article class="content-section">
    <h2>Understanding Fractions</h2>
    <p>Fractions represent parts of a whole. When we write 3/4, the bottom number (denominator) tells us how many equal parts the whole is divided into, and the top number (numerator) tells us how many of those parts we are talking about. Fractions are used everywhere in daily life: cooking recipes call for 1/2 cup of flour, construction measurements use 3/8 inch, and stores offer 1/3 off sales. Building a strong foundation in fractions is essential because they lead directly to decimals, percentages, ratios, and algebra.</p>
    <p>These free printable fractions worksheets cover seven types of fraction practice, from visual identification to arithmetic with unlike denominators. Every worksheet is randomly generated, giving you an unlimited supply of practice material.</p>

    <h2>Types of Fraction Problems</h2>
    <h3>Identify Fractions (Visual)</h3>
    <p>Students look at a shape divided into equal parts with some parts shaded and write the fraction that represents the shaded portion. This is the most concrete way to understand fractions. A circle divided into 4 equal parts with 3 shaded represents 3/4. This visual approach builds the foundational understanding that fractions represent parts of a whole.</p>

    <h3>Equivalent Fractions</h3>
    <p>Two fractions are equivalent when they represent the same amount. For example, 1/2 = 2/4 = 3/6. Students practice finding equivalent fractions by multiplying or dividing both the numerator and denominator by the same number. This skill is essential for comparing fractions and performing fraction arithmetic.</p>

    <h3>Compare Fractions</h3>
    <p>Students compare two fractions using &gt;, &lt;, or = symbols. For fractions with the same denominator, the larger numerator means the larger fraction. For different denominators, students find a common denominator first, then compare. This builds number sense with non-whole numbers.</p>

    <h3>Add and Subtract (Same Denominator)</h3>
    <p>When fractions have the same denominator, addition and subtraction are straightforward: keep the denominator and add or subtract the numerators. For example, 2/5 + 1/5 = 3/5. Results are simplified when possible.</p>

    <h3>Add and Subtract (Different Denominators)</h3>
    <p>When denominators differ, students must first find the least common denominator (LCD), convert both fractions, then add or subtract. For example, 1/3 + 1/4 requires converting to 4/12 + 3/12 = 7/12. This is among the most challenging fraction skills in elementary mathematics.</p>

    <h2>Grade-Level Guide</h2>
    <h3>Third Grade (Ages 8-9)</h3>
    <p>Third graders are introduced to fractions as parts of a whole. They work with unit fractions (1/2, 1/3, 1/4) and learn to identify fractions from visual models. Use the "Identify Fractions" type with "Up to 4" denominator. They also begin comparing fractions with the same denominator or same numerator.</p>

    <h3>Fourth Grade (Ages 9-10)</h3>
    <p>Fourth graders work extensively with equivalent fractions, comparing fractions with different denominators, and adding and subtracting fractions with like denominators. Use "Up to 8" denominator and try the "Equivalent," "Compare," "Add (Same)," and "Subtract (Same)" types. Students learn that fractions can be represented in multiple equivalent forms.</p>

    <h3>Fifth Grade (Ages 10-11)</h3>
    <p>Fifth graders master addition and subtraction of fractions with unlike denominators. They learn to find the least common denominator, convert fractions, and simplify results. Use "Up to 12" denominator with the "Add (Different)" and "Subtract (Different)" types for grade-appropriate challenge. This is a critical skill that prepares students for middle school mathematics.</p>

    <h2>Tips for Teaching Fractions</h2>
    <ul>
      <li><strong>Use visual models extensively.</strong> Fraction circles, fraction bars, and number lines make abstract fraction concepts tangible. The "Identify" mode on these worksheets provides built-in visual practice.</li>
      <li><strong>Emphasize equal parts.</strong> The most common misconception is that fractions do not require equal-sized parts. Always stress that the denominator represents equal divisions of the whole.</li>
      <li><strong>Build equivalent fraction fluency.</strong> Students who understand equivalent fractions find comparing and computing with fractions much easier. Practice multiplying both top and bottom by the same number.</li>
      <li><strong>Connect to real life.</strong> Use cooking, measuring, and sharing situations to show fractions in context. "If we cut a pizza into 8 slices and eat 3, what fraction is left?"</li>
      <li><strong>Teach simplification gradually.</strong> Start with fraction problems that do not require simplifying, then introduce the concept of greatest common factor (GCF) and simplification as a separate skill.</li>
      <li><strong>Use the "Max Denominator" setting wisely.</strong> Smaller denominators (up to 4) are appropriate for beginners, while larger denominators (up to 12) challenge more advanced students.</li>
    </ul>

    <h2>How to Use These Fractions Worksheets</h2>
    <p>Select the number of problems, problem type, and maximum denominator using the settings above. Click "Generate New" for a fresh worksheet. The "Identify" type includes visual circle diagrams that students analyze. All other types present fraction expressions for students to solve. Use "Print" for a clean page and "Show Answers" to check work or use the answer key for grading.</p>

    <h2>Related Worksheets</h2>
    <ul>
      <li><a href="/worksheets/division-worksheets/">Division Worksheets</a> - Practice division facts and long division.</li>
      <li><a href="/worksheets/multiplication-worksheets/">Multiplication Worksheets</a> - Times tables and multi-digit multiplication.</li>
      <li><a href="/worksheets/comparing-numbers-worksheets/">Comparing Numbers Worksheets</a> - Practice using &gt;, &lt;, and = symbols.</li>
      <li><a href="/worksheets/order-of-operations-worksheets/">Order of Operations Worksheets</a> - PEMDAS practice with mixed operations.</li>
    </ul>
  </article>

  <AdUnit slot="ws-bottom" format="horizontal" />
</BaseLayout>

<script is:inline>
  var problems = [];

  function randInt(min, max) {
    return Math.floor(Math.random() * (max - min + 1)) + min;
  }

  function gcd(a, b) {
    a = Math.abs(a); b = Math.abs(b);
    while (b) { var t = b; b = a % b; a = t; }
    return a;
  }

  function lcm(a, b) {
    return (a * b) / gcd(a, b);
  }

  function simplify(num, den) {
    if (den === 0) return { num: 0, den: 1 };
    var g = gcd(Math.abs(num), Math.abs(den));
    return { num: num / g, den: den / g };
  }

  function fractionStr(num, den) {
    var s = simplify(num, den);
    if (s.den === 1) return String(s.num);
    return s.num + '/' + s.den;
  }

  function fractionHTML(num, den, cls) {
    var s = simplify(num, den);
    if (s.den === 1) return '<span class="frac-whole ' + (cls || '') + '">' + s.num + '</span>';
    return '<span class="frac ' + (cls || '') + '"><span class="frac-num">' + s.num + '</span><span class="frac-bar"></span><span class="frac-den">' + s.den + '</span></span>';
  }

  function drawCircleSVG(num, den) {
    var size = 80;
    var cx = size / 2, cy = size / 2, r = 35;
    var svg = '<svg width="' + size + '" height="' + size + '" viewBox="0 0 ' + size + ' ' + size + '" class="frac-svg">';

    for (var i = 0; i < den; i++) {
      var startAngle = (i / den) * 2 * Math.PI - Math.PI / 2;
      var endAngle = ((i + 1) / den) * 2 * Math.PI - Math.PI / 2;
      var x1 = cx + r * Math.cos(startAngle);
      var y1 = cy + r * Math.sin(startAngle);
      var x2 = cx + r * Math.cos(endAngle);
      var y2 = cy + r * Math.sin(endAngle);
      var largeArc = (endAngle - startAngle > Math.PI) ? 1 : 0;
      var fill = i < num ? '#2563eb' : '#e2e8f0';
      var d = 'M ' + cx + ' ' + cy + ' L ' + x1.toFixed(2) + ' ' + y1.toFixed(2) + ' A ' + r + ' ' + r + ' 0 ' + largeArc + ' 1 ' + x2.toFixed(2) + ' ' + y2.toFixed(2) + ' Z';
      svg += '<path d="' + d + '" fill="' + fill + '" stroke="#334155" stroke-width="1.5"/>';
    }

    svg += '<circle cx="' + cx + '" cy="' + cy + '" r="' + r + '" fill="none" stroke="#334155" stroke-width="1.5"/>';
    svg += '</svg>';
    return svg;
  }

  function generateProblems() {
    var count = parseInt(document.getElementById('cfgProblems').value, 10);
    var type = document.getElementById('cfgType').value;
    var maxDenom = parseInt(document.getElementById('cfgMaxDenom').value, 10);

    if (isNaN(count) || count < 5) count = 5;
    if (count > 30) count = 30;

    problems = [];

    for (var i = 0; i < count; i++) {
      var prob = { type: type };

      if (type === 'identify') {
        var den = randInt(2, maxDenom);
        var num = randInt(1, den - 1);
        prob.num = num;
        prob.den = den;
        prob.answer = num + '/' + den;
        prob.answerHTML = fractionHTML(num, den);
      } else if (type === 'equivalent') {
        var den = randInt(2, Math.max(2, Math.floor(maxDenom / 2)));
        var num = randInt(1, den - 1);
        var mult = randInt(2, Math.max(2, Math.floor(maxDenom / den)));
        prob.num1 = num;
        prob.den1 = den;
        prob.den2 = den * mult;
        prob.answerNum = num * mult;
        prob.answer = (num * mult) + '/' + (den * mult);
        prob.answerHTML = fractionHTML(num * mult, den * mult);
      } else if (type === 'compare') {
        var den1 = randInt(2, maxDenom);
        var num1 = randInt(1, den1 - 1);
        var den2 = randInt(2, maxDenom);
        var num2 = randInt(1, den2 - 1);
        var val1 = num1 / den1;
        var val2 = num2 / den2;
        prob.num1 = num1; prob.den1 = den1;
        prob.num2 = num2; prob.den2 = den2;
        prob.answer = val1 > val2 ? '>' : val1 < val2 ? '<' : '=';
      } else if (type === 'addSame' || type === 'subSame') {
        var den = randInt(2, maxDenom);
        var a, b;
        if (type === 'addSame') {
          a = randInt(1, den - 1);
          b = randInt(1, den - a);
        } else {
          a = randInt(2, den - 1);
          b = randInt(1, a - 1);
        }
        prob.num1 = a; prob.den1 = den;
        prob.num2 = b; prob.den2 = den;
        prob.op = type === 'addSame' ? '+' : '-';
        var resNum = type === 'addSame' ? a + b : a - b;
        prob.answer = fractionStr(resNum, den);
        prob.answerHTML = fractionHTML(resNum, den);
      } else {
        // addDiff / subDiff
        var den1 = randInt(2, maxDenom);
        var den2 = randInt(2, maxDenom);
        while (den2 === den1) den2 = randInt(2, maxDenom);
        var lcd = lcm(den1, den2);
        var num1, num2;
        if (type === 'addDiff') {
          num1 = randInt(1, den1 - 1);
          num2 = randInt(1, den2 - 1);
          var resNum = num1 * (lcd / den1) + num2 * (lcd / den2);
        } else {
          // Ensure positive result
          var attempts = 0;
          do {
            num1 = randInt(1, den1 - 1);
            num2 = randInt(1, den2 - 1);
            var resNum = num1 * (lcd / den1) - num2 * (lcd / den2);
            attempts++;
          } while (resNum <= 0 && attempts < 100);
          if (resNum <= 0) { num1 = den1 - 1; num2 = 1; resNum = num1 * (lcd / den1) - num2 * (lcd / den2); }
        }
        prob.num1 = num1; prob.den1 = den1;
        prob.num2 = num2; prob.den2 = den2;
        prob.op = type === 'addDiff' ? '+' : '-';
        prob.answer = fractionStr(resNum, lcd);
        prob.answerHTML = fractionHTML(resNum, lcd);
      }

      problems.push(prob);
    }

    renderProblems();
    renderAnswerKey();
    updateAnswerVisibility();
  }

  function renderProblems() {
    var grid = document.getElementById('problemGrid');
    var showAnswers = document.getElementById('toggleAnswers').checked;
    var html = '';

    for (var i = 0; i < problems.length; i++) {
      var p = problems[i];
      html += '<div class="problem frac-problem">';
      html += '<div class="problem-number">' + (i + 1) + ')</div>';

      if (p.type === 'identify') {
        html += '<div class="frac-visual">' + drawCircleSVG(p.num, p.den) + '</div>';
        html += '<div class="problem-answer' + (showAnswers ? ' revealed' : '') + '">';
        html += showAnswers ? p.answerHTML : '<span class="frac"><span class="frac-num">?</span><span class="frac-bar"></span><span class="frac-den">?</span></span>';
        html += '</div>';
      } else if (p.type === 'equivalent') {
        html += '<div class="frac-expr">';
        html += fractionHTML(p.num1, p.den1) + ' = ';
        html += '<span class="frac"><span class="frac-num">' + (showAnswers ? p.answerNum : '?') + '</span><span class="frac-bar"></span><span class="frac-den">' + p.den2 + '</span></span>';
        html += '</div>';
      } else if (p.type === 'compare') {
        html += '<div class="frac-expr">';
        html += fractionHTML(p.num1, p.den1);
        html += ' <span class="cmp-box' + (showAnswers ? ' revealed' : '') + '">' + (showAnswers ? p.answer : '') + '</span> ';
        html += fractionHTML(p.num2, p.den2);
        html += '</div>';
      } else {
        html += '<div class="frac-expr">';
        html += fractionHTML(p.num1, p.den1) + ' ' + p.op + ' ' + fractionHTML(p.num2, p.den2) + ' = ';
        html += '<span class="problem-answer' + (showAnswers ? ' revealed' : '') + '">';
        html += showAnswers ? p.answerHTML : '?';
        html += '</span>';
        html += '</div>';
      }

      html += '</div>';
    }

    grid.innerHTML = html;
  }

  function renderAnswerKey() {
    var answerGrid = document.getElementById('answerGrid');
    var html = '';
    for (var i = 0; i < problems.length; i++) {
      html += '<div class="answer-item">';
      html += '<span class="q">' + (i + 1) + '.</span>';
      html += '<span class="a">' + problems[i].answer + '</span>';
      html += '</div>';
    }
    answerGrid.innerHTML = html;
  }

  function updateAnswerVisibility() {
    var showAnswers = document.getElementById('toggleAnswers').checked;
    var answerKey = document.getElementById('answerKey');
    if (showAnswers) { answerKey.classList.remove('hidden'); }
    else { answerKey.classList.add('hidden'); }
    renderProblems();
  }

  document.getElementById('btnGenerate').addEventListener('click', generateProblems);
  document.getElementById('btnPrint').addEventListener('click', function () { window.print(); });
  document.getElementById('toggleAnswers').addEventListener('change', updateAnswerVisibility);
  generateProblems();
</script>

<style>
  :global(.frac-problem) {
    flex-direction: column !important;
    align-items: center !important;
    gap: 8px;
    min-height: 100px;
  }
  :global(.frac-visual) {
    display: flex;
    justify-content: center;
  }
  :global(.frac-svg) {
    display: block;
  }
  :global(.frac-expr) {
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 1.15rem;
    flex-wrap: wrap;
  }
  :global(.frac) {
    display: inline-flex;
    flex-direction: column;
    align-items: center;
    vertical-align: middle;
    text-align: center;
    line-height: 1.2;
  }
  :global(.frac-num),
  :global(.frac-den) {
    display: block;
    font-weight: 600;
    padding: 0 4px;
    min-width: 20px;
  }
  :global(.frac-bar) {
    display: block;
    height: 2px;
    background: var(--color-text);
    width: 100%;
    min-width: 20px;
  }
  :global(.frac-whole) {
    font-weight: 600;
    font-size: 1.15rem;
  }
  :global(.frac-problem .cmp-box) {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 36px;
    height: 32px;
    border: 2px solid var(--color-border);
    border-radius: 4px;
    font-size: 1.1rem;
    font-weight: 700;
    color: var(--color-primary);
    background: #fff;
  }
  :global(.frac-problem .cmp-box.revealed) {
    border-color: var(--color-primary);
    background: rgba(37, 99, 235, 0.06);
  }
  @media print {
    :global(.frac-svg path[fill="#2563eb"]) { fill: #666 !important; }
    :global(.frac-problem .cmp-box) { border-color: #333; }
  }
</style>
