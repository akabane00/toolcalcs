---
import BaseLayout from '../../layouts/BaseLayout.astro';
import AdUnit from '../../components/AdUnit.astro';
import { getWorksheetBySlug } from '../../data/worksheets';
import '../../styles/worksheet.css';

const ws = getWorksheetBySlug('order-of-operations-worksheets')!;

const structuredData = {
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position": 1,
      "name": "Home",
      "item": "https://toolcalcs.com/"
    },
    {
      "@type": "ListItem",
      "position": 2,
      "name": "Worksheets",
      "item": "https://toolcalcs.com/worksheets/"
    },
    {
      "@type": "ListItem",
      "position": 3,
      "name": "Order of Operations Worksheets"
    }
  ]
};
---

<BaseLayout
  title="Free Order of Operations Worksheets (PEMDAS) - Printable | ToolCalcs"
  description={ws.description}
  type="article"
  structuredData={structuredData}
>
  <nav class="breadcrumb">
    <a href="/">Home</a> &rsaquo;
    <a href="/worksheets/">Worksheets</a> &rsaquo;
    <span>Order of Operations Worksheets</span>
  </nav>

  <h1>{ws.title}</h1>
  <p class="page-desc">{ws.description}</p>

  <div class="worksheet-box">
    <div class="config-panel">
      <h3>Settings</h3>
      <div class="config-inputs">
        <div class="config-group">
          <label for="cfgProblems">Number of Problems</label>
          <input type="number" id="cfgProblems" value="15" min="5" max="30" />
        </div>
        <div class="config-group">
          <label for="cfgDifficulty">Difficulty</label>
          <select id="cfgDifficulty">
            <option value="basic">Basic (2 operations, no parentheses)</option>
            <option value="medium">Medium (2-3 operations, parentheses)</option>
            <option value="advanced">Advanced (3-4 operations, exponents)</option>
          </select>
        </div>
        <div class="config-group">
          <label for="cfgMaxNumber">Max Number</label>
          <select id="cfgMaxNumber">
            <option value="9" selected>Up to 9</option>
            <option value="12">Up to 12</option>
            <option value="20">Up to 20</option>
          </select>
        </div>
      </div>
    </div>

    <div class="worksheet-actions">
      <button class="ws-btn primary" id="btnGenerate">Generate New</button>
      <button class="ws-btn print" id="btnPrint">Print</button>
      <label class="toggle-label">
        <input type="checkbox" id="toggleAnswers" />
        Show Answers
      </label>
    </div>

    <div class="worksheet-content" id="worksheetContent">
      <div class="worksheet-header-print">
        <h2>Order of Operations (PEMDAS)</h2>
        <div class="name-date">
          <span>Name: ___________________</span>
          <span>Date: ___________________</span>
        </div>
      </div>
      <div class="problem-grid" id="problemGrid"></div>
      <div class="answer-key hidden" id="answerKey">
        <h3>Answer Key</h3>
        <div class="answer-grid" id="answerGrid"></div>
      </div>
    </div>
  </div>

  <AdUnit slot="ws-mid" format="rectangle" />

  <article class="content-section">
    <h2>What Is the Order of Operations?</h2>
    <p>The order of operations is a set of rules that tells us the sequence in which to evaluate a mathematical expression. Without these rules, the same expression could produce different answers depending on the order you choose to calculate. For example, does 3 + 4 &times; 2 equal 14 or 11? The order of operations tells us to multiply first, making the answer 11. These rules ensure that everyone arrives at the same answer for the same expression.</p>
    <p>The most common mnemonic for remembering the order of operations is PEMDAS (sometimes recalled as "Please Excuse My Dear Aunt Sally"):</p>
    <ul>
      <li><strong>P</strong> - Parentheses first</li>
      <li><strong>E</strong> - Exponents (powers and roots)</li>
      <li><strong>M/D</strong> - Multiplication and Division (left to right)</li>
      <li><strong>A/S</strong> - Addition and Subtraction (left to right)</li>
    </ul>
    <p>These free printable order of operations worksheets provide unlimited practice at three difficulty levels, from basic two-operation expressions to advanced problems with parentheses and exponents.</p>

    <h2>Difficulty Levels Explained</h2>
    <h3>Basic</h3>
    <p>Basic problems use two operations and no parentheses. Students must determine which operation to perform first based on the standard order. Examples include: 6 + 3 &times; 4, 15 - 8 &divide; 2, and 5 &times; 3 + 7. These problems teach students that multiplication and division take priority over addition and subtraction.</p>

    <h3>Medium</h3>
    <p>Medium problems introduce parentheses and use 2-3 operations. Parentheses override the standard order, requiring students to evaluate the expression inside first. Examples include: (4 + 3) &times; 5, 12 &divide; (6 - 2), and 3 &times; (8 - 5) + 2. These problems teach students that parentheses always come first, regardless of which operations they contain.</p>

    <h3>Advanced</h3>
    <p>Advanced problems include 3-4 operations with parentheses and exponents (squares and cubes). Examples include: 4&sup2; + 3 &times; 2, (5 + 2)&sup2; - 10, and 3 &times; 2&sup3; - 4 &divide; 2. These problems require students to apply the full PEMDAS hierarchy and are appropriate for students in grades 5-6 and above.</p>

    <h2>Grade-Level Guide</h2>
    <h3>Fourth Grade (Ages 9-10)</h3>
    <p>Fourth graders are typically introduced to the order of operations with simple, two-operation expressions. Use the "Basic" difficulty with "Up to 9" number range. Focus on helping students understand why 3 + 4 &times; 2 does not equal 14 and that multiplication and division are performed before addition and subtraction.</p>

    <h3>Fifth Grade (Ages 10-11)</h3>
    <p>Fifth graders work with parentheses and begin to encounter more complex multi-step expressions. Use the "Medium" difficulty. Students should be comfortable with the idea that parentheses override the standard order. Practice with expressions like (7 + 3) &times; 4 helps reinforce this concept.</p>

    <h3>Sixth Grade (Ages 11-12)</h3>
    <p>Sixth graders apply the full order of operations including exponents. Use the "Advanced" difficulty for a comprehensive challenge. Students should be able to evaluate expressions like 2&sup3; + 5 &times; (4 - 1) systematically, working through each level of the PEMDAS hierarchy.</p>

    <h2>Common Mistakes and How to Avoid Them</h2>
    <ul>
      <li><strong>Working left to right without considering operation priority.</strong> The most common error is performing operations in left-to-right order without regard to PEMDAS. Remind students that multiplication/division always comes before addition/subtraction, even if addition appears first in the expression.</li>
      <li><strong>Treating M before D (or A before S).</strong> PEMDAS can mislead students into thinking multiplication always comes before division. In fact, multiplication and division have equal priority and are evaluated left to right. The same applies to addition and subtraction.</li>
      <li><strong>Forgetting to evaluate inside parentheses first.</strong> Some students skip the parentheses and start with multiplication or another operation outside them. Drill the habit of always looking for parentheses first.</li>
      <li><strong>Incorrect exponent calculation.</strong> Students sometimes multiply the base by the exponent instead of raising to a power. 3&sup2; means 3 &times; 3 = 9, not 3 &times; 2 = 6.</li>
    </ul>

    <h2>Tips for Teaching Order of Operations</h2>
    <ul>
      <li><strong>Start with why.</strong> Show students that without rules, the same expression gives different answers. This motivates learning the rules rather than memorizing them mechanically.</li>
      <li><strong>Use the PEMDAS mnemonic.</strong> While mnemonics have limitations, "Please Excuse My Dear Aunt Sally" gives students a starting framework. Just be sure to clarify that M/D and A/S are evaluated left to right, not M before D.</li>
      <li><strong>Progress gradually.</strong> Start with basic two-operation problems before introducing parentheses, then exponents. Each new element builds on the last.</li>
      <li><strong>Show all steps.</strong> When working through problems, write out each step on a separate line. This makes the process transparent and helps students see the order clearly.</li>
      <li><strong>Generate fresh worksheets often.</strong> Because these worksheets produce new random problems each time, students get varied practice that prevents rote memorization of specific answers.</li>
    </ul>

    <h2>How to Use These Worksheets</h2>
    <p>Select the number of problems, difficulty level, and maximum number using the settings above. Click "Generate New" for a fresh set of problems. Each problem includes one expression that students evaluate step by step. Use "Print" for a clean page and "Show Answers" to check work or use the answer key for grading.</p>

    <h2>Related Worksheets</h2>
    <ul>
      <li><a href="/worksheets/fractions-worksheets/">Fractions Worksheets</a> - Practice identifying, comparing, and computing fractions.</li>
      <li><a href="/worksheets/multiplication-worksheets/">Multiplication Worksheets</a> - Times tables and multi-digit multiplication practice.</li>
      <li><a href="/worksheets/division-worksheets/">Division Worksheets</a> - Division facts and long division.</li>
      <li><a href="/worksheets/addition-worksheets/">Addition Worksheets</a> - Multi-digit addition practice.</li>
    </ul>
  </article>

  <AdUnit slot="ws-bottom" format="horizontal" />
</BaseLayout>

<script is:inline>
  var problems = [];

  function randInt(min, max) {
    return Math.floor(Math.random() * (max - min + 1)) + min;
  }

  // Template-based expression generator
  // Each template is [display, evaluator] where evaluator returns the answer
  function generateBasic(maxN) {
    var templates = [
      function() {
        var a = randInt(1, maxN), b = randInt(1, maxN), c = randInt(1, maxN);
        return { expr: a + ' + ' + b + ' \u00d7 ' + c, answer: a + b * c };
      },
      function() {
        var a = randInt(1, maxN), b = randInt(1, maxN), c = randInt(1, maxN);
        return { expr: a + ' \u00d7 ' + b + ' + ' + c, answer: a * b + c };
      },
      function() {
        var a = randInt(1, maxN), b = randInt(1, maxN), c = randInt(1, maxN);
        var result = a * b - c;
        if (result < 0) { a = maxN; c = randInt(1, Math.max(1, a * b - 1)); result = a * b - c; }
        return { expr: a + ' \u00d7 ' + b + ' - ' + c, answer: result };
      },
      function() {
        var b = randInt(1, maxN), c = randInt(1, Math.max(1, Math.floor(maxN / 2)));
        var a = b * c;
        var d = randInt(1, maxN);
        return { expr: a + ' \u00f7 ' + b + ' + ' + d, answer: c + d };
      },
      function() {
        var b = randInt(2, maxN), c = randInt(1, Math.max(1, Math.floor(maxN / 2)));
        var a = b * c;
        var d = randInt(1, maxN);
        return { expr: d + ' + ' + a + ' \u00f7 ' + b, answer: d + c };
      },
      function() {
        var b = randInt(2, maxN), c = randInt(1, Math.max(1, Math.floor(maxN / 2)));
        var a = b * c;
        var d = randInt(0, c);
        return { expr: a + ' \u00f7 ' + b + ' - ' + d, answer: c - d };
      },
    ];

    var t = templates[randInt(0, templates.length - 1)];
    return t();
  }

  function generateMedium(maxN) {
    var templates = [
      function() {
        var a = randInt(1, maxN), b = randInt(1, maxN), c = randInt(1, maxN);
        return { expr: '(' + a + ' + ' + b + ') \u00d7 ' + c, answer: (a + b) * c };
      },
      function() {
        var a = randInt(1, maxN), b = randInt(1, maxN), c = randInt(1, maxN);
        return { expr: c + ' \u00d7 (' + a + ' + ' + b + ')', answer: c * (a + b) };
      },
      function() {
        var a = randInt(2, maxN), b = randInt(1, a - 1), c = randInt(1, maxN);
        return { expr: '(' + a + ' - ' + b + ') \u00d7 ' + c, answer: (a - b) * c };
      },
      function() {
        var a = randInt(1, maxN), b = randInt(1, maxN);
        var inner = a + b;
        var d = randInt(2, Math.max(2, Math.min(maxN, 6)));
        while (inner % d !== 0) { b++; inner = a + b; }
        return { expr: '(' + a + ' + ' + b + ') \u00f7 ' + d, answer: inner / d };
      },
      function() {
        var a = randInt(1, maxN), b = randInt(1, maxN), c = randInt(1, maxN), d = randInt(1, maxN);
        var result = a * b + c * d;
        return { expr: a + ' \u00d7 ' + b + ' + ' + c + ' \u00d7 ' + d, answer: result };
      },
      function() {
        var a = randInt(1, maxN), b = randInt(1, maxN), c = randInt(1, maxN);
        var result = (a + b) * c;
        var e = randInt(0, result);
        return { expr: '(' + a + ' + ' + b + ') \u00d7 ' + c + ' - ' + e, answer: result - e };
      },
    ];

    var t = templates[randInt(0, templates.length - 1)];
    return t();
  }

  function generateAdvanced(maxN) {
    var templates = [
      function() {
        var a = randInt(2, Math.min(maxN, 9)), b = randInt(1, maxN);
        return { expr: a + '\u00b2 + ' + b, answer: a * a + b };
      },
      function() {
        var a = randInt(2, Math.min(maxN, 9)), b = randInt(1, a * a);
        return { expr: a + '\u00b2 - ' + b, answer: a * a - b };
      },
      function() {
        var a = randInt(2, Math.min(maxN, 5)), b = randInt(1, maxN);
        return { expr: a + '\u00b2 \u00d7 ' + b, answer: a * a * b };
      },
      function() {
        var a = randInt(1, maxN), b = randInt(1, maxN), c = randInt(2, Math.min(maxN, 9));
        return { expr: a + ' + ' + b + ' \u00d7 ' + c + '\u00b2', answer: a + b * c * c };
      },
      function() {
        var a = randInt(1, Math.min(maxN, 6)), b = randInt(1, Math.min(maxN, 6));
        var inner = a + b;
        return { expr: '(' + a + ' + ' + b + ')\u00b2', answer: inner * inner };
      },
      function() {
        var a = randInt(2, Math.min(maxN, 4));
        var b = randInt(1, maxN);
        return { expr: a + '\u00b3 + ' + b, answer: a * a * a + b };
      },
      function() {
        var a = randInt(2, Math.min(maxN, 9)), b = randInt(1, maxN), c = randInt(1, maxN);
        return { expr: a + '\u00b2 + ' + b + ' \u00d7 ' + c, answer: a * a + b * c };
      },
      function() {
        var a = randInt(2, Math.min(maxN, 9)), b = randInt(2, maxN);
        var sq = a * a;
        while (sq % b !== 0) { a++; sq = a * a; }
        var c = randInt(1, maxN);
        return { expr: a + '\u00b2 \u00f7 ' + b + ' + ' + c, answer: sq / b + c };
      },
    ];

    var t = templates[randInt(0, templates.length - 1)];
    return t();
  }

  function generateProblems() {
    var count = parseInt(document.getElementById('cfgProblems').value, 10);
    var difficulty = document.getElementById('cfgDifficulty').value;
    var maxN = parseInt(document.getElementById('cfgMaxNumber').value, 10);

    if (isNaN(count) || count < 5) count = 5;
    if (count > 30) count = 30;

    problems = [];
    var attempts = 0;
    while (problems.length < count && attempts < count * 10) {
      attempts++;
      var prob;
      if (difficulty === 'basic') prob = generateBasic(maxN);
      else if (difficulty === 'medium') prob = generateMedium(maxN);
      else prob = generateAdvanced(maxN);

      // Ensure positive integer answer
      if (prob.answer < 0 || prob.answer !== Math.floor(prob.answer)) continue;

      // Avoid duplicates
      var isDup = false;
      for (var j = 0; j < problems.length; j++) {
        if (problems[j].expr === prob.expr) { isDup = true; break; }
      }
      if (!isDup) problems.push(prob);
    }

    renderProblems();
    renderAnswerKey();
    updateAnswerVisibility();
  }

  function renderProblems() {
    var grid = document.getElementById('problemGrid');
    var showAnswers = document.getElementById('toggleAnswers').checked;
    var html = '';

    for (var i = 0; i < problems.length; i++) {
      var p = problems[i];
      html += '<div class="problem oo-problem">';
      html += '<div class="problem-number">' + (i + 1) + ')</div>';
      html += '<div class="problem-text oo-expr">' + p.expr + ' =</div>';
      html += '<div class="problem-answer' + (showAnswers ? ' revealed' : '') + '">';
      html += showAnswers ? p.answer : '______';
      html += '</div>';
      html += '</div>';
    }

    grid.innerHTML = html;
  }

  function renderAnswerKey() {
    var answerGrid = document.getElementById('answerGrid');
    var html = '';
    for (var i = 0; i < problems.length; i++) {
      html += '<div class="answer-item">';
      html += '<span class="q">' + (i + 1) + '.</span>';
      html += '<span class="a">' + problems[i].answer + '</span>';
      html += '</div>';
    }
    answerGrid.innerHTML = html;
  }

  function updateAnswerVisibility() {
    var showAnswers = document.getElementById('toggleAnswers').checked;
    var answerKey = document.getElementById('answerKey');
    if (showAnswers) { answerKey.classList.remove('hidden'); }
    else { answerKey.classList.add('hidden'); }
    renderProblems();
  }

  document.getElementById('btnGenerate').addEventListener('click', generateProblems);
  document.getElementById('btnPrint').addEventListener('click', function () { window.print(); });
  document.getElementById('toggleAnswers').addEventListener('change', updateAnswerVisibility);
  generateProblems();
</script>

<style>
  :global(.oo-problem) {
    align-items: center !important;
    gap: 10px;
  }
  :global(.oo-expr) {
    font-size: 1.15rem;
    font-weight: 500;
    letter-spacing: 0.5px;
  }
</style>
