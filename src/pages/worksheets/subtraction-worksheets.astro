---
import BaseLayout from '../../layouts/BaseLayout.astro';
import AdUnit from '../../components/AdUnit.astro';
import { getWorksheetBySlug } from '../../data/worksheets';
import '../../styles/worksheet.css';

const ws = getWorksheetBySlug('subtraction-worksheets')!;

const structuredData = [
  {
    "@context": "https://schema.org",
    "@type": "BreadcrumbList",
    "itemListElement": [
      {
        "@type": "ListItem",
        "position": 1,
        "name": "Home",
        "item": "https://toolcalcs.com/"
      },
      {
        "@type": "ListItem",
        "position": 2,
        "name": "Worksheets",
        "item": "https://toolcalcs.com/worksheets/"
      },
      {
        "@type": "ListItem",
        "position": 3,
        "name": "Subtraction Worksheets"
      }
    ]
  },
  {
    "@context": "https://schema.org",
    "@type": "FAQPage",
    "mainEntity": [
      {
        "@type": "Question",
        "name": "How do you subtract multi-digit numbers?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "To subtract multi-digit numbers, line the numbers up vertically by place value. Start subtracting from the rightmost column (ones place) and work left. If the top digit is smaller than the bottom digit, borrow 1 from the next column to the left. For example, in 52 - 37, you borrow from the 5 to make 12 - 7 = 5 in the ones column, then 4 - 3 = 1 in the tens column, giving 15."
        }
      },
      {
        "@type": "Question",
        "name": "What is borrowing (regrouping) in subtraction?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "Borrowing, also called regrouping, is the process of taking 1 from the next higher place value when the top digit is smaller than the bottom digit in a subtraction problem. For example, in 43 - 28, you cannot subtract 8 from 3, so you borrow 1 ten from the 4 (making it 3) and add 10 to the ones column (making it 13). Then 13 - 8 = 5 and 3 - 2 = 1, giving 15."
        }
      },
      {
        "@type": "Question",
        "name": "Can subtraction give a negative answer?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "Yes. When you subtract a larger number from a smaller number, the result is negative. For example, 3 - 7 = -4. Negative numbers are typically introduced around 6th grade. For younger learners, subtraction worksheets usually ensure the first number is larger so all answers are positive."
        }
      }
    ]
  }
];
---

<BaseLayout
  title="Free Subtraction Worksheets - Printable Math Practice | ToolCalcs"
  description={ws.description}
  type="article"
  structuredData={structuredData}
>
  <nav class="breadcrumb">
    <a href="/">Home</a> &rsaquo;
    <a href="/worksheets/">Worksheets</a> &rsaquo;
    <span>Subtraction Worksheets</span>
  </nav>

  <h1>{ws.title}</h1>
  <p class="page-desc">{ws.description}</p>

  <div class="worksheet-box">
    <div class="config-panel">
      <h3>Worksheet Settings</h3>
      <div class="config-inputs">
        <div class="config-group">
          <label for="cfg-problems">Number of Problems</label>
          <input type="number" id="cfg-problems" min="5" max="50" value="20" />
        </div>
        <div class="config-group">
          <label for="cfg-maxDigits">Max Digits</label>
          <select id="cfg-maxDigits">
            <option value="1">1 Digit (0-9)</option>
            <option value="2">2 Digits (10-99)</option>
            <option value="3">3 Digits (100-999)</option>
          </select>
        </div>
        <div class="config-group">
          <label for="cfg-negative">Allow Negative Answers</label>
          <select id="cfg-negative">
            <option value="no">No</option>
            <option value="yes">Yes</option>
          </select>
        </div>
      </div>
    </div>

    <div class="worksheet-actions">
      <button class="ws-btn primary" id="btn-generate">Generate New</button>
      <button class="ws-btn print" id="btn-print">Print</button>
      <label class="toggle-label">
        <input type="checkbox" id="chk-answers" />
        Show Answers
      </label>
    </div>

    <div class="worksheet-content" id="worksheet-area">
      <div class="worksheet-header-print">
        <h2>Subtraction Practice</h2>
        <div class="name-date">
          <span>Name: ________________________</span>
          <span>Date: ________________________</span>
        </div>
      </div>
      <div class="problem-grid" id="problem-grid"></div>
      <div class="answer-key hidden" id="answer-key">
        <h3>Answer Key</h3>
        <div class="answer-grid" id="answer-grid"></div>
      </div>
    </div>
  </div>

  <AdUnit slot="ws-mid" format="horizontal" />

  <article class="content-section">
    <h2>About Our Free Subtraction Worksheets</h2>
    <p>
      These free printable subtraction worksheets give students unlimited practice with subtraction facts and multi-digit subtraction problems. Every time you click "Generate New," a fresh set of randomized problems is created, so students never run out of material. All worksheets are formatted for clean printing on standard letter-size paper.
    </p>
    <p>
      Whether your child is just learning basic subtraction facts or working through multi-digit problems that require borrowing (regrouping), these worksheets adapt to the right difficulty level. Teachers and homeschool parents can quickly produce differentiated practice sheets for an entire class by adjusting the settings above.
    </p>

    <h2>How to Use These Subtraction Worksheets</h2>
    <p>
      Start by selecting the settings that match your student's current skill level. Choose the number of problems, the maximum number of digits, and whether to allow negative answers. Then click "Generate New" to create a fresh worksheet. You can toggle "Show Answers" to reveal the answer key, which also prints on a separate page for easy grading.
    </p>
    <h3>Choosing the Right Difficulty</h3>
    <ul>
      <li><strong>1-Digit Subtraction (0-9):</strong> Best for kindergarten and first-grade students who are learning basic subtraction facts. Problems are displayed horizontally for easy reading.</li>
      <li><strong>2-Digit Subtraction (10-99):</strong> Appropriate for first through third graders who are practicing regrouping (borrowing). Problems appear in vertical column format.</li>
      <li><strong>3-Digit Subtraction (100-999):</strong> Designed for second through fourth graders working on multi-step regrouping across multiple place values.</li>
    </ul>

    <h2>Understanding Subtraction and Borrowing</h2>
    <p>
      Subtraction is one of the four fundamental arithmetic operations. It represents the process of removing objects from a collection or finding the difference between two quantities. The number being subtracted from is called the <em>minuend</em>, the number being subtracted is the <em>subtrahend</em>, and the result is called the <em>difference</em>.
    </p>
    <p>
      When students progress to multi-digit subtraction, they encounter borrowing (also known as regrouping). Borrowing is necessary when a digit in the minuend is smaller than the corresponding digit in the subtrahend. For example, when solving 42 - 17, the student must borrow 1 ten from the tens column, converting the problem to 12 - 7 in the ones column and 3 - 1 in the tens column, resulting in 25.
    </p>
    <h3>The Role of Negative Numbers</h3>
    <p>
      By default, these worksheets ensure that every answer is zero or positive by generating problems where the first number is always greater than or equal to the second. When you enable "Allow Negative Answers," both numbers are generated independently, which means some answers may be negative. This option is useful for older students who are ready to explore integers and the number line beyond zero.
    </p>

    <h2>Tips for Teaching Subtraction</h2>
    <ul>
      <li><strong>Use concrete objects first.</strong> Before moving to paper worksheets, let young learners physically remove objects from a group. Counters, blocks, and fingers help build an intuitive understanding of "taking away."</li>
      <li><strong>Connect addition and subtraction.</strong> Help students see that subtraction is the inverse of addition. If 3 + 4 = 7, then 7 - 4 = 3. Fact families reinforce this relationship.</li>
      <li><strong>Practice number bonds.</strong> Breaking numbers into parts (for instance, 8 = 5 + 3) strengthens mental subtraction skills and prepares students for regrouping.</li>
      <li><strong>Master facts to 20.</strong> Fluency with subtraction facts within 20 is the foundation for all multi-digit work. Aim for automatic recall through regular, short practice sessions.</li>
      <li><strong>Teach borrowing step by step.</strong> Use place-value charts and base-ten blocks to demonstrate what happens when you regroup. Let students see that borrowing 1 ten is the same as adding 10 ones.</li>
    </ul>

    <h2>When to Introduce Each Level</h2>
    <p>
      Most math curricula introduce single-digit subtraction in kindergarten and first grade, starting with facts within 10 and progressing to facts within 20. Two-digit subtraction without regrouping typically appears in first grade, with regrouping introduced in second grade. Three-digit subtraction with multiple regrouping steps is a common second- and third-grade skill. By fourth grade, students are expected to subtract numbers of any size fluently.
    </p>
    <p>
      Regular practice with printable worksheets reinforces classroom instruction and helps students build the speed and accuracy they need for more advanced math topics like multi-step word problems, measurement conversions, and algebraic reasoning.
    </p>
  </article>

  <AdUnit slot="ws-bottom" format="horizontal" />
</BaseLayout>

<script>
  const problemGrid = document.getElementById('problem-grid')!;
  const answerGrid = document.getElementById('answer-grid')!;
  const answerKey = document.getElementById('answer-key')!;
  const btnGenerate = document.getElementById('btn-generate')!;
  const btnPrint = document.getElementById('btn-print')!;
  const chkAnswers = document.getElementById('chk-answers') as HTMLInputElement;
  const cfgProblems = document.getElementById('cfg-problems') as HTMLInputElement;
  const cfgMaxDigits = document.getElementById('cfg-maxDigits') as HTMLSelectElement;
  const cfgNegative = document.getElementById('cfg-negative') as HTMLSelectElement;

  interface Problem {
    a: number;
    b: number;
    answer: number;
  }

  function randInt(min: number, max: number): number {
    return Math.floor(Math.random() * (max - min + 1)) + min;
  }

  function getRange(digits: number): { min: number; max: number } {
    if (digits === 1) return { min: 0, max: 9 };
    if (digits === 2) return { min: 10, max: 99 };
    return { min: 100, max: 999 };
  }

  function generateProblems(): Problem[] {
    const count = Math.min(50, Math.max(5, parseInt(cfgProblems.value) || 20));
    const digits = parseInt(cfgMaxDigits.value) || 1;
    const allowNegative = cfgNegative.value === 'yes';
    const range = getRange(digits);
    const problems: Problem[] = [];

    for (let i = 0; i < count; i++) {
      let a: number, b: number;

      if (allowNegative) {
        a = randInt(range.min, range.max);
        b = randInt(range.min, range.max);
      } else {
        a = randInt(range.min, range.max);
        b = randInt(range.min, a);
      }

      problems.push({ a, b, answer: a - b });
    }

    return problems;
  }

  function renderProblems(problems: Problem[]): void {
    const digits = parseInt(cfgMaxDigits.value) || 1;
    const isVertical = digits > 1;
    let html = '';

    problems.forEach((p, i) => {
      const num = i + 1;
      if (isVertical) {
        const maxLen = Math.max(p.a.toString().length, p.b.toString().length);
        const aStr = p.a.toString().padStart(maxLen, '\u00A0');
        const bStr = p.b.toString().padStart(maxLen, '\u00A0');
        html += `<div class="problem">
          <div class="problem-number">${num}</div>
          <div class="problem-vertical">
            <span>${aStr}</span>
            <span class="operator">&minus; ${bStr}</span>
            <div class="line"></div>
            <span class="problem-answer" data-answer="${p.answer}">&nbsp;</span>
          </div>
        </div>`;
      } else {
        html += `<div class="problem">
          <div class="problem-number">${num}</div>
          <div class="problem-text">${p.a} &minus; ${p.b} = <span class="problem-answer" data-answer="${p.answer}">___</span></div>
        </div>`;
      }
    });

    problemGrid.innerHTML = html;

    let answerHtml = '';
    problems.forEach((p, i) => {
      answerHtml += `<div class="answer-item"><span class="q">${i + 1}.</span> <span class="a">${p.answer}</span></div>`;
    });
    answerGrid.innerHTML = answerHtml;

    updateAnswerVisibility();
  }

  function updateAnswerVisibility(): void {
    const show = chkAnswers.checked;
    answerKey.classList.toggle('hidden', !show);

    const answerEls = problemGrid.querySelectorAll('.problem-answer');
    answerEls.forEach(el => {
      const span = el as HTMLElement;
      if (show) {
        span.textContent = span.dataset.answer || '';
        span.classList.add('revealed');
      } else {
        const digits = parseInt(cfgMaxDigits.value) || 1;
        span.textContent = digits > 1 ? '\u00A0' : '___';
        span.classList.remove('revealed');
      }
    });
  }

  function init(): void {
    const problems = generateProblems();
    renderProblems(problems);
  }

  btnGenerate.addEventListener('click', init);
  btnPrint.addEventListener('click', () => window.print());
  chkAnswers.addEventListener('change', updateAnswerVisibility);

  init();
</script>
